{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{useEffect,useState}from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import FlatList from\"react-native-web/dist/exports/FlatList\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import{useLoan}from\"../../contexts/LoanContext\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function LoanOfficerNotifications(_ref){var navigation=_ref.navigation;var _useLoan=useLoan(),notifications=_useLoan.notifications,markNotificationsAsRead=_useLoan.markNotificationsAsRead,loans=_useLoan.loans,refreshClientData=_useLoan.refreshClientData;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isRefreshing=_useState2[0],setIsRefreshing=_useState2[1];useEffect(function(){markNotificationsAsRead();},[]);useEffect(function(){var unsubscribe=navigation.addListener('focus',function(){console.log('LoanOfficerNotifications focused - refreshing data');setIsRefreshing(true);Promise.all(loans.map(function(loan){return refreshClientData(loan.cid);})).catch(function(err){return console.error('Error refreshing client data:',err);}).finally(function(){return setIsRefreshing(false);});});return unsubscribe;},[navigation,loans]);var renderItem=function renderItem(_ref2){var item=_ref2.item;var isApproved=item.status==='Approved';return _jsxs(View,{style:styles.item,children:[item.type==='status_change'?_jsxs(_Fragment,{children:[_jsx(Text,{style:[styles.icon,{color:isApproved?'green':'red'}],children:isApproved?'‚úÖ':'‚ùå'}),_jsxs(Text,{style:styles.message,children:[\"CID \",_jsx(Text,{style:styles.bold,children:item.cid}),\" LOAN REQUEST HAS BEEN\",' ',_jsx(Text,{style:[styles.status,{color:isApproved?'green':'red'}],children:item.status.toUpperCase()}),' ',\"BY THE OPERATIONAL MANAGER\"]})]}):_jsxs(_Fragment,{children:[_jsx(Text,{style:[styles.icon,{color:'#007bff'}],children:\"\\uD83D\\uDCB0\"}),_jsxs(Text,{style:styles.message,children:[\"Loan amount for client\",' ',_jsx(Text,{style:styles.bold,children:item.clientName}),\" (CID: \",item.cid,\") has been updated to\",' ',_jsxs(Text,{style:styles.bold,children:[\"\\u20B1\",item.amount.toLocaleString()]})]})]}),_jsx(Text,{style:styles.timestamp,children:new Date(item.timestamp).toLocaleString()})]});};return _jsxs(View,{style:styles.container,children:[_jsxs(View,{style:styles.headerRow,children:[_jsx(Text,{style:styles.header,children:\"Hello Loan Officer!\"}),_jsx(TouchableOpacity,{style:styles.dashboardBtn,onPress:function onPress(){return navigation.navigate('LoanOfficerDashboard');},children:_jsx(Text,{style:styles.btnText,children:\"Go to Dashboard\"})})]}),_jsx(Text,{style:styles.subHeader,children:\"Notifications\"}),isRefreshing&&_jsx(View,{style:styles.refreshingContainer,children:_jsx(Text,{style:styles.refreshingText,children:\"Refreshing...\"})}),_jsx(FlatList,{data:notifications,keyExtractor:function keyExtractor(item){return item.id.toString();},renderItem:renderItem,ItemSeparatorComponent:function ItemSeparatorComponent(){return _jsx(View,{style:styles.separator});}})]});}var styles=StyleSheet.create({container:{padding:24,backgroundColor:'#f6f6f6',flex:1},headerRow:{flexDirection:'row',justifyContent:'space-between',alignItems:'center',marginBottom:16},header:{fontSize:24,fontWeight:'bold'},dashboardBtn:{backgroundColor:'#007bff',paddingVertical:8,paddingHorizontal:14,borderRadius:6},btnText:{color:'#fff',fontWeight:'600',fontSize:14},subHeader:{fontSize:18,fontWeight:'600',marginBottom:16},item:{flexDirection:'row',alignItems:'flex-start',paddingVertical:6},icon:{fontSize:18,marginRight:10,marginTop:2},message:{flex:1,fontSize:14,fontWeight:'500'},bold:{fontWeight:'bold'},status:{fontWeight:'bold',textTransform:'uppercase'},separator:{borderBottomWidth:1,borderColor:'#ccc',marginVertical:6},timestamp:{fontSize:12,color:'#666',marginTop:4,fontStyle:'italic'},refreshingContainer:{padding:10,backgroundColor:'#f0f0f0',alignItems:'center'},refreshingText:{color:'#666',fontSize:14}});","map":{"version":3,"names":["React","useEffect","useState","View","Text","FlatList","TouchableOpacity","StyleSheet","useLoan","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LoanOfficerNotifications","_ref","navigation","_useLoan","notifications","markNotificationsAsRead","loans","refreshClientData","_useState","_useState2","_slicedToArray","isRefreshing","setIsRefreshing","unsubscribe","addListener","console","log","Promise","all","map","loan","cid","catch","err","error","finally","renderItem","_ref2","item","isApproved","status","style","styles","children","type","icon","color","message","bold","toUpperCase","clientName","amount","toLocaleString","timestamp","Date","container","headerRow","header","dashboardBtn","onPress","navigate","btnText","subHeader","refreshingContainer","refreshingText","data","keyExtractor","id","toString","ItemSeparatorComponent","separator","create","padding","backgroundColor","flex","flexDirection","justifyContent","alignItems","marginBottom","fontSize","fontWeight","paddingVertical","paddingHorizontal","borderRadius","marginRight","marginTop","textTransform","borderBottomWidth","borderColor","marginVertical","fontStyle"],"sources":["C:/Users/ajohn/loansiya-webapp1.3.4/src/screens/loanofficer/LoanOfficerNotifications.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { View, Text, FlatList, TouchableOpacity, StyleSheet } from 'react-native';\r\nimport { useLoan } from '../../contexts/LoanContext';\r\n\r\nexport default function LoanOfficerNotifications({ navigation }) {\r\n  const { notifications, markNotificationsAsRead, loans, refreshClientData } = useLoan();\r\n  const [isRefreshing, setIsRefreshing] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // Mark notifications as read when screen is opened\r\n    markNotificationsAsRead();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = navigation.addListener('focus', () => {\r\n      console.log('LoanOfficerNotifications focused - refreshing data');\r\n      setIsRefreshing(true);\r\n      \r\n      // Refresh all loans to get latest status\r\n      Promise.all(loans.map(loan => refreshClientData(loan.cid)))\r\n        .catch(err => console.error('Error refreshing client data:', err))\r\n        .finally(() => setIsRefreshing(false));\r\n    });\r\n\r\n    return unsubscribe;\r\n  }, [navigation, loans]);\r\n  const renderItem = ({ item }) => {\r\n    const isApproved = item.status === 'Approved';\r\n    \r\n    return (\r\n      <View style={styles.item}>\r\n        {item.type === 'status_change' ? (\r\n          <>\r\n            <Text style={[styles.icon, { color: isApproved ? 'green' : 'red' }]}>\r\n              {isApproved ? '‚úÖ' : '‚ùå'}\r\n            </Text>\r\n            <Text style={styles.message}>\r\n              CID <Text style={styles.bold}>{item.cid}</Text> LOAN REQUEST HAS BEEN{' '}\r\n              <Text style={[styles.status, { color: isApproved ? 'green' : 'red' }]}>\r\n                {item.status.toUpperCase()}\r\n              </Text>{' '}\r\n              BY THE OPERATIONAL MANAGER\r\n            </Text>\r\n          </>\r\n        ) : (\r\n          <>\r\n            <Text style={[styles.icon, { color: '#007bff' }]}>üí∞</Text>\r\n            <Text style={styles.message}>\r\n              Loan amount for client{' '}\r\n              <Text style={styles.bold}>{item.clientName}</Text> (CID: {item.cid})\r\n              has been updated to{' '}\r\n              <Text style={styles.bold}>‚Ç±{item.amount.toLocaleString()}</Text>\r\n            </Text>\r\n          </>\r\n        )}\r\n        <Text style={styles.timestamp}>\r\n          {new Date(item.timestamp).toLocaleString()}\r\n        </Text>\r\n      </View>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      {/* Top Header with Dashboard Button */}\r\n      <View style={styles.headerRow}>\r\n        <Text style={styles.header}>Hello Loan Officer!</Text>\r\n        <TouchableOpacity\r\n          style={styles.dashboardBtn}\r\n          onPress={() => navigation.navigate('LoanOfficerDashboard')}\r\n        >\r\n          <Text style={styles.btnText}>Go to Dashboard</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n\r\n      {/* Section Title */}\r\n      <Text style={styles.subHeader}>Notifications</Text>\r\n\r\n      {/* Notification List */}\r\n      {isRefreshing && (\r\n        <View style={styles.refreshingContainer}>\r\n          <Text style={styles.refreshingText}>Refreshing...</Text>\r\n        </View>\r\n      )}\r\n      <FlatList\r\n        data={notifications}\r\n        keyExtractor={(item) => item.id.toString()}\r\n        renderItem={renderItem}\r\n        ItemSeparatorComponent={() => <View style={styles.separator} />}\r\n      />\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    padding: 24,\r\n    backgroundColor: '#f6f6f6',\r\n    flex: 1,\r\n  },\r\n  headerRow: {\r\n    flexDirection: 'row',\r\n    justifyContent: 'space-between',\r\n    alignItems: 'center',\r\n    marginBottom: 16,\r\n  },\r\n  header: {\r\n    fontSize: 24,\r\n    fontWeight: 'bold',\r\n  },\r\n  dashboardBtn: {\r\n    backgroundColor: '#007bff',\r\n    paddingVertical: 8,\r\n    paddingHorizontal: 14,\r\n    borderRadius: 6,\r\n  },\r\n  btnText: {\r\n    color: '#fff',\r\n    fontWeight: '600',\r\n    fontSize: 14,\r\n  },\r\n  subHeader: {\r\n    fontSize: 18,\r\n    fontWeight: '600',\r\n    marginBottom: 16,\r\n  },\r\n  item: {\r\n    flexDirection: 'row',\r\n    alignItems: 'flex-start',\r\n    paddingVertical: 6,\r\n  },\r\n  icon: {\r\n    fontSize: 18,\r\n    marginRight: 10,\r\n    marginTop: 2,\r\n  },\r\n  message: {\r\n    flex: 1,\r\n    fontSize: 14,\r\n    fontWeight: '500',\r\n  },\r\n  bold: {\r\n    fontWeight: 'bold',\r\n  },\r\n  status: {\r\n    fontWeight: 'bold',\r\n    textTransform: 'uppercase',\r\n  },\r\n  separator: {\r\n    borderBottomWidth: 1,\r\n    borderColor: '#ccc',\r\n    marginVertical: 6,\r\n  },\r\n  timestamp: {\r\n    fontSize: 12,\r\n    color: '#666',\r\n    marginTop: 4,\r\n    fontStyle: 'italic'\r\n  },\r\n  refreshingContainer: {\r\n    padding: 10,\r\n    backgroundColor: '#f0f0f0',\r\n    alignItems: 'center',\r\n  },\r\n  refreshingText: {\r\n    color: '#666',\r\n    fontSize: 14,\r\n  }\r\n});\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}