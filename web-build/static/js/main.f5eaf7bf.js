(()=>{"use strict";var e={2607:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o});const o={}},4454:(e,t,n)=>{var o=n(603),l=n(6665),r=n(6520),a=n(1959),i=n(467),d=n(296),s=n(3929),c=n(6283),u=n(6773),f=n(5648),g=n(3668),h=n(558),b=n(5991),p=n(397),m=(0,l.createContext)({currentUser:null,setCurrentUser:function(){},resetPassword:function(){},logout:function(){}}),y=function(e){var t=e.children,n=(0,l.useState)((function(){var e=localStorage.getItem("currentUser");return e?JSON.parse(e):null})),o=(0,d.default)(n,2),r=o[0],a=o[1];(0,l.useEffect)((function(){r?localStorage.setItem("currentUser",JSON.stringify(r)):localStorage.removeItem("currentUser")}),[r]);var s=function(){var e=(0,i.default)((function*(e,t){if(!e||!t)throw new Error("Username and new password are required");return new Promise((function(e){setTimeout((function(){e({success:!0,message:"Password reset successful"})}),1e3)}))}));return function(t,n){return e.apply(this,arguments)}}();return(0,p.jsx)(m.Provider,{value:{currentUser:r,setCurrentUser:a,resetPassword:s,logout:function(){a(null)}},children:t})},x=n(4467),w=n(6950);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){(0,x.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C=function(){var e,t,n,o;return console.log("Environment debug info:",{NODE_ENV:"production",REACT_APP_API_URL:{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"LoanSiya Web App",slug:"loansiya-webapp",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",userInterfaceStyle:"light",newArchEnabled:!0,splash:{image:"./assets/splash-icon.png",resizeMode:"contain",backgroundColor:"#ffffff"},web:{},extra:{REACT_APP_API_URL:"https://loansiya-api-38767014727.asia-southeast1.run.app"},sdkVersion:"48.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.REACT_APP_API_URL,expoConfig:null==(e=w.default.expoConfig)||null==(t=e.extra)?void 0:t.REACT_APP_API_URL,isProduction:!0}),{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"LoanSiya Web App",slug:"loansiya-webapp",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",userInterfaceStyle:"light",newArchEnabled:!0,splash:{image:"./assets/splash-icon.png",resizeMode:"contain",backgroundColor:"#ffffff"},web:{},extra:{REACT_APP_API_URL:"https://loansiya-api-38767014727.asia-southeast1.run.app"},sdkVersion:"48.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.REACT_APP_API_URL?(console.log("Using production env var:",{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"LoanSiya Web App",slug:"loansiya-webapp",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",userInterfaceStyle:"light",newArchEnabled:!0,splash:{image:"./assets/splash-icon.png",resizeMode:"contain",backgroundColor:"#ffffff"},web:{},extra:{REACT_APP_API_URL:"https://loansiya-api-38767014727.asia-southeast1.run.app"},sdkVersion:"48.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.REACT_APP_API_URL),{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"LoanSiya Web App",slug:"loansiya-webapp",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",userInterfaceStyle:"light",newArchEnabled:!0,splash:{image:"./assets/splash-icon.png",resizeMode:"contain",backgroundColor:"#ffffff"},web:{},extra:{REACT_APP_API_URL:"https://loansiya-api-38767014727.asia-southeast1.run.app"},sdkVersion:"48.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.REACT_APP_API_URL):null!=(n=w.default.expoConfig)&&null!=(o=n.extra)&&o.REACT_APP_API_URL?(console.log("Using Expo config:",w.default.expoConfig.extra.REACT_APP_API_URL),w.default.expoConfig.extra.REACT_APP_API_URL):{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"LoanSiya Web App",slug:"loansiya-webapp",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",userInterfaceStyle:"light",newArchEnabled:!0,splash:{image:"./assets/splash-icon.png",resizeMode:"contain",backgroundColor:"#ffffff"},web:{},extra:{REACT_APP_API_URL:"https://loansiya-api-38767014727.asia-southeast1.run.app"},sdkVersion:"48.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.REACT_APP_API_URL?(console.log("Using env var fallback:",{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"LoanSiya Web App",slug:"loansiya-webapp",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",userInterfaceStyle:"light",newArchEnabled:!0,splash:{image:"./assets/splash-icon.png",resizeMode:"contain",backgroundColor:"#ffffff"},web:{},extra:{REACT_APP_API_URL:"https://loansiya-api-38767014727.asia-southeast1.run.app"},sdkVersion:"48.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.REACT_APP_API_URL),{NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"LoanSiya Web App",slug:"loansiya-webapp",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",userInterfaceStyle:"light",newArchEnabled:!0,splash:{image:"./assets/splash-icon.png",resizeMode:"contain",backgroundColor:"#ffffff"},web:{},extra:{REACT_APP_API_URL:"https://loansiya-api-38767014727.asia-southeast1.run.app"},sdkVersion:"48.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.REACT_APP_API_URL):(console.log("Using localhost fallback"),"http://localhost:5600")}(),S={login:function(){var e=(0,i.default)((function*(e,t){try{var n=yield fetch(C+"/officers/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})});if(!n.ok){var o=yield n.json();throw new Error(o.message||"Login failed")}var l=yield n.json();if(!l.success)throw new Error(l.message||"Login failed");return{user:{username:l.officer.username,fullName:l.officer.fullName,role:l.officer.role,status:l.officer.status}}}catch(o){throw console.error("Login Error:",o),o}}));return function(t,n){return e.apply(this,arguments)}}()},T={getAllUsers:function(){var e=(0,i.default)((function*(){try{var e=yield fetch(C+"/users");if(!e.ok)throw new Error("Failed to fetch users");return e.json()}catch(t){throw console.error("API Error:",t),t}}));return function(){return e.apply(this,arguments)}}(),updateUserStatus:function(){var e=(0,i.default)((function*(e,t){try{var n=yield fetch(C+"/users/"+e+"/status",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})});if(!n.ok)throw new Error("Failed to update user status");return n.json()}catch(o){throw console.error("API Error:",o),o}}));return function(t,n){return e.apply(this,arguments)}}(),addUser:function(){var e=(0,i.default)((function*(e){try{var t=yield fetch(C+"/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){var n=yield t.json();throw new Error(n.error||"Failed to add user")}return t.json()}catch(n){throw console.error("API Error:",n),n}}));return function(t){return e.apply(this,arguments)}}(),updateUser:function(){var e=(0,i.default)((function*(e,t){try{var n=yield fetch(C+"/users/"+e,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){var o=yield n.json();throw new Error(o.error||"Failed to update user")}return n.json()}catch(o){throw console.error("API Error:",o),o}}));return function(t,n){return e.apply(this,arguments)}}()},P={"Valid Id":"validid",ORCR:"orcr","Land Title":"landtitle","Deeds of Assignment":"deed","Promissory Note":"promissory-note"},B={APPLICATION_DOCS:["Valid Id","ORCR","Land Title","Deeds of Assignment"],SIGNED_DOCS:["Promissory Note","Signed Agreement"]},D={getAllClients:function(){var e=(0,i.default)((function*(){try{console.log("Fetching clients from:",C);var e=yield fetch(C+"/clients");if(!e.ok)throw new Error("Failed to fetch clients");return e.json()}catch(t){throw console.error("API Error:",t),t}}));return function(){return e.apply(this,arguments)}}(),getClientById:function(){var e=(0,i.default)((function*(e){try{var t=yield fetch(C+"/client/"+e);if(!t.ok)throw new Error("Failed to fetch client");return t.json()}catch(n){throw console.error("API Error:",n),n}}));return function(t){return e.apply(this,arguments)}}(),getClientScore:function(){var e=(0,i.default)((function*(e){try{var t=yield fetch(C+"/score/"+e,{method:"POST"});if(!t.ok)throw new Error("Failed to fetch client score");return t.json()}catch(n){throw console.error("API Error:",n),n}}));return function(t){return e.apply(this,arguments)}}(),processMetrics:function(){var e=(0,i.default)((function*(e){try{var t=yield fetch(C+"/metrics/"+e,{method:"POST"});if(!t.ok)throw new Error("Failed to process metrics");return t.json()}catch(n){throw console.error("API Error:",n),n}}));return function(t){return e.apply(this,arguments)}}(),processLoanDecision:function(){var e=(0,i.default)((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{var o=yield fetch(C+"/loan/"+e+"/decision",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v({decision:t},n))});if(!o.ok)throw new Error("Failed to process loan decision");return o.json()}catch(l){throw console.error("API Error:",l),l}}));return function(t,n){return e.apply(this,arguments)}}(),fetchClientLoanData:function(){var e=(0,i.default)((function*(e){try{var t=yield fetch(C+"/client-loan-data/"+e);if(!t.ok)throw new Error("Failed to fetch loan data");return t.json()}catch(n){throw console.error("API Error:",n),n}}));return function(t){return e.apply(this,arguments)}}(),updateLoanAmount:function(){var e=(0,i.default)((function*(e,t){try{var n=yield fetch(C+"/loan/"+e+"/amount",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:t})});if(!n.ok)throw new Error("Failed to update loan amount");return n.json()}catch(o){throw console.error("API Error:",o),o}}));return function(t,n){return e.apply(this,arguments)}}(),notifications:{getNotifications:function(){var e=(0,i.default)((function*(){try{var e=yield fetch(C+"/notifications");if(!e.ok)throw new Error("Failed to fetch notifications");return e.json()}catch(t){throw console.error("API Error:",t),t}}));return function(){return e.apply(this,arguments)}}(),createNotification:function(){var e=(0,i.default)((function*(e){try{var t=yield fetch(C+"/notifications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to create notification");return t.json()}catch(n){throw console.error("API Error:",n),n}}));return function(t){return e.apply(this,arguments)}}(),markAsRead:function(){var e=(0,i.default)((function*(e){try{var t=yield fetch(C+"/notifications/mark-read",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({notificationIds:e})});if(!t.ok)throw new Error("Failed to mark notifications as read");return t.json()}catch(n){throw console.error("API Error:",n),n}}));return function(t){return e.apply(this,arguments)}}()},viewDocumentByFilename:function(){var e=(0,i.default)((function*(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{var o=e.toString().padStart(3,"0");console.log("Fetching document file:",t,"for CID:",o,"date:",n);var l=C+"/documents/"+o+"/file/"+encodeURIComponent(t);n&&(l+="?date="+encodeURIComponent(n));var r=yield fetch(l);if(!r.ok){var a=yield r.json();throw new Error(a.error||"Failed to fetch document")}var i=r.headers.get("content-type"),d=yield r.blob();return{url:URL.createObjectURL(new Blob([d],{type:i})),type:i}}catch(s){throw console.error("API Error:",s),s}}));return function(t,n){return e.apply(this,arguments)}}(),viewDocument:function(){var e=(0,i.default)((function*(e,t){try{var n=e.toString().padStart(3,"0"),o=P[t];if(!o)throw new Error("Invalid document type: "+t);var l=encodeURIComponent(o);console.log("Fetching document:",t,"as",o,"for CID:",n);var r=yield fetch(C+"/documents/"+n+"/"+l);if(!r.ok){var a=yield r.json();throw new Error(a.error||"Failed to fetch document")}var i=r.headers.get("content-type"),d=yield r.blob();return{url:URL.createObjectURL(new Blob([d],{type:i})),type:i}}catch(s){throw console.error("API Error:",s),s}}));return function(t,n){return e.apply(this,arguments)}}(),getLatestDocuments:function(){var e=(0,i.default)((function*(e){try{var t=e.toString().padStart(3,"0");console.log("Getting documents for padded CID:",t);var n=yield fetch(C+"/documents/"+t+"/all");if(!n.ok){var o=yield n.json();throw new Error(o.error||"Failed to fetch documents")}return(yield n.json()).documents}catch(l){throw console.error("API Error:",l),l}}));return function(t){return e.apply(this,arguments)}}(),getDocumentDates:function(){var e=(0,i.default)((function*(e){try{var t=e.toString().padStart(3,"0");console.log("Getting document dates for padded CID:",t);var n=yield fetch(C+"/documents/"+t+"/dates");if(!n.ok){var o=yield n.json();throw new Error(o.error||"Failed to fetch document dates")}return(yield n.json()).dates}catch(l){throw console.error("API Error:",l),l}}));return function(t){return e.apply(this,arguments)}}(),getDocumentsByDate:function(){var e=(0,i.default)((function*(e,t){try{var n=e.toString().padStart(3,"0");console.log("Getting documents for padded CID:",n,"date:",t);var o=yield fetch(C+"/documents/"+n+"/date/"+t);if(!o.ok){var l=yield o.json();throw new Error(l.error||"Failed to fetch documents")}return(yield o.json()).documents}catch(r){throw console.error("API Error:",r),r}}));return function(t,n){return e.apply(this,arguments)}}()};function A(e){var t=e.navigation,n=(0,l.useContext)(m),o=n.setCurrentUser,r=n.currentUser;(0,l.useEffect)((function(){r&&("IT_ADMIN"===r.role?t.navigate("Dashboard"):"OPS_MANAGER"===r.role?t.navigate("OpsDashboard"):"LOAN_OFFICER"===r.role&&t.navigate("LoanOfficerDashboard"))}),[r,t]);var a=(0,h.default)().width<768,g=(0,l.useState)(""),b=(0,d.default)(g,2),y=b[0],x=b[1],w=(0,l.useState)(""),j=(0,d.default)(w,2),v=j[0],C=j[1],T=(0,l.useState)(!1),P=(0,d.default)(T,2),B=P[0],D=P[1],A=function(){var e=(0,i.default)((function*(){try{D(!0);var e=yield S.login(y,v);e.user&&(o(e.user),"IT_ADMIN"===e.user.role?t.navigate("Dashboard"):"OPS_MANAGER"===e.user.role?t.navigate("OpsDashboard"):"LOAN_OFFICER"===e.user.role&&t.navigate("LoanOfficerDashboard"))}catch(n){alert(n.message||"Login failed. Please check your credentials.")}finally{D(!1)}}));return function(){return e.apply(this,arguments)}}();return(0,p.jsx)(s.default,{style:M.container,children:(0,p.jsxs)(s.default,{style:[M.card,a&&M.cardMobile],children:[(0,p.jsx)(c.default,{style:M.title,children:"LoanSiya Log-in Portal"}),(0,p.jsx)(c.default,{style:M.label,children:"Username"}),(0,p.jsx)(u.default,{style:M.input,onChangeText:x,value:y}),(0,p.jsx)(c.default,{style:M.label,children:"Password"}),(0,p.jsx)(u.default,{style:M.input,secureTextEntry:!0,onChangeText:C,value:v}),(0,p.jsx)(f.default,{style:[M.loginBtn,B&&M.loginBtnDisabled],onPress:A,disabled:B,children:(0,p.jsx)(c.default,{style:M.loginText,children:B?"Logging in...":"Login"})}),(0,p.jsx)(f.default,{onPress:function(){return t.navigate("ForgotPassword")},children:(0,p.jsx)(c.default,{style:M.forgotText,children:"Forgot Password?"})})]})})}var M=g.default.create({container:{flex:1,backgroundColor:"#f6f6f6",justifyContent:"center",alignItems:"center",padding:b.default.select({web:40,default:20})},card:{backgroundColor:"#fff",padding:b.default.select({web:40,default:24}),borderRadius:12,width:"100%",maxWidth:400,elevation:5,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4},cardMobile:{padding:20,width:"95%"},title:{fontSize:b.default.select({web:24,default:20}),fontWeight:"700",textAlign:"center",marginBottom:b.default.select({web:30,default:20}),color:"#333"},label:{fontSize:b.default.select({web:16,default:14}),marginBottom:8,color:"#333",fontWeight:"500"},input:{backgroundColor:"#e1e1e1",padding:b.default.select({web:14,default:12}),borderRadius:8,marginBottom:20,fontSize:b.default.select({web:16,default:14}),borderWidth:1,borderColor:"#ccc"},loginBtn:{backgroundColor:"#007bff",paddingVertical:b.default.select({web:14,default:12}),borderRadius:8,marginTop:10,alignItems:"center",width:"100%"},loginBtnDisabled:{backgroundColor:"#ccc",opacity:.7},errorText:{color:"red",textAlign:"center",marginBottom:10},loginBtnDisabled:{backgroundColor:"#ccc",opacity:.7},loginText:{color:"#fff",fontWeight:"600",fontSize:b.default.select({web:16,default:14})},forgotText:{textAlign:"center",marginTop:16,color:"#007bff",textDecorationLine:"underline",fontSize:b.default.select({web:14,default:12})}});function O(e){var t=e.navigation,n=(0,l.useState)(1),o=(0,d.default)(n,2),r=o[0],a=o[1],i=(0,l.useState)(""),g=(0,d.default)(i,2),h=g[0],b=g[1],m=(0,l.useState)(""),y=(0,d.default)(m,2),x=y[0],w=y[1],j=(0,l.useState)(""),v=(0,d.default)(j,2),C=v[0],S=v[1],T=(0,l.useState)(""),P=(0,d.default)(T,2),B=P[0],D=P[1],A=(0,l.useState)(!1),M=(0,d.default)(A,2),O=(M[0],M[1]),L=[{username:"admin",role:"IT_ADMIN"},{username:"officer1",role:"OFFICER"}],k=function(){var e=L.find((function(e){return e.username===h}));e?(O("IT_ADMIN"===e.role),"IT_ADMIN"===e.role?a(2):a(4)):alert("Username not found!")},I=function(){C===B?C.length<6?alert("Password must be at least 6 characters long!"):a(3):alert("Passwords do not match!")};return(0,p.jsx)(s.default,{style:R.container,children:(0,p.jsxs)(s.default,{style:R.card,children:[1===r&&(0,p.jsxs)(s.default,{children:[(0,p.jsx)(c.default,{style:R.title,children:"Forgot Password"}),(0,p.jsx)(c.default,{style:R.subtitle,children:"Enter your username (ex. officer1)"}),(0,p.jsx)(c.default,{style:R.label,children:"Enter Username:"}),(0,p.jsx)(u.default,{style:R.input,value:h,onChangeText:b,placeholder:"Username"}),(0,p.jsx)(f.default,{style:R.submitBtn,onPress:k,children:(0,p.jsx)(c.default,{style:R.submitText,children:"Submit"})})]}),2===r&&(0,p.jsxs)(s.default,{children:[(0,p.jsx)(c.default,{style:R.title,children:"Hello Admin!"}),(0,p.jsx)(c.default,{style:R.label,children:"Email:"}),(0,p.jsx)(u.default,{style:R.input,value:x,onChangeText:w,placeholder:"Enter your email",keyboardType:"email-address"}),(0,p.jsx)(c.default,{style:R.label,children:"New Password:"}),(0,p.jsx)(u.default,{style:R.input,value:C,onChangeText:S,secureTextEntry:!0,placeholder:"Enter new password"}),(0,p.jsx)(c.default,{style:R.label,children:"Confirm Password:"}),(0,p.jsx)(u.default,{style:R.input,value:B,onChangeText:D,secureTextEntry:!0,placeholder:"Confirm new password"}),(0,p.jsx)(f.default,{style:R.submitBtn,onPress:I,children:(0,p.jsx)(c.default,{style:R.submitText,children:"Submit"})})]}),3===r&&(0,p.jsxs)(s.default,{children:[(0,p.jsx)(c.default,{style:R.title,children:"Hello Admin!"}),(0,p.jsx)(c.default,{style:R.message,children:"Please check your email, we have sent you a confirmation."}),(0,p.jsx)(f.default,{style:R.submitBtn,onPress:function(){return t.navigate("Login")},children:(0,p.jsx)(c.default,{style:R.submitText,children:"Back to Login"})})]}),4===r&&(0,p.jsxs)(s.default,{children:[(0,p.jsx)(c.default,{style:R.title,children:"Hello!"}),(0,p.jsx)(c.default,{style:R.message,children:"Please contact the IT Admin for password assistance!"}),(0,p.jsx)(f.default,{style:R.submitBtn,onPress:function(){return t.navigate("Login")},children:(0,p.jsx)(c.default,{style:R.submitText,children:"Back to Login"})})]})]})})}var R=g.default.create({container:{flex:1,backgroundColor:"#f6f6f6",justifyContent:"center",alignItems:"center"},card:{backgroundColor:"#fff",padding:30,borderRadius:10,width:"90%",maxWidth:400,elevation:5},title:{fontSize:22,fontWeight:"700",textAlign:"center",marginBottom:15},subtitle:{fontSize:16,textAlign:"center",marginBottom:20,color:"#666"},label:{fontSize:14,marginBottom:6,color:"#333"},input:{backgroundColor:"#e1e1e1",padding:12,borderRadius:8,marginBottom:16},submitBtn:{backgroundColor:"#007bff",paddingVertical:12,borderRadius:6,marginTop:10,alignItems:"center"},submitText:{color:"#fff",fontWeight:"600"},message:{textAlign:"center",fontSize:16,marginVertical:20,color:"#666"}}),L=(0,l.createContext)({users:[],loading:!1,addUser:function(e){},updateUser:function(e){},refreshUsers:function(){}}),k=function(e){var t=e.children,n=(0,l.useState)([]),o=(0,d.default)(n,2),r=o[0],a=o[1],s=(0,l.useState)(!1),c=(0,d.default)(s,2),u=c[0],f=c[1],g=function(){var e=(0,i.default)((function*(){try{f(!0);var e=yield T.getAllUsers();a(e)}catch(t){console.error("Error fetching users:",t)}finally{f(!1)}}));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){g()}),[]);var h=function(){var e=(0,i.default)((function*(e){try{if(!e.username||!e.fullName||!e.role||!e.password)throw new Error("Username, full name, role, and password are required");f(!0);var t=yield T.addUser(e);return yield g(),t.user}catch(n){throw console.error("Error adding user:",n),n}finally{f(!1)}}));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=(0,i.default)((function*(e){try{if(!e.id&&!e.username)throw new Error("User ID or username is required for updating");var t=e.username||e.id;if(f(!0),2===Object.keys(e).length&&e.status)yield T.updateUserStatus(t,e.status);else{var n={};e.fullName&&(n.fullName=e.fullName),e.role&&(n.role=e.role),e.status&&(n.status=e.status),e.password&&(n.password=e.password),yield T.updateUser(t,n)}yield g()}catch(o){throw console.error("Error updating user:",o),o}finally{f(!1)}}));return function(t){return e.apply(this,arguments)}}();return(0,p.jsx)(L.Provider,{value:{users:r,loading:u,addUser:h,updateUser:b,refreshUsers:g},children:t})};function I(e){var t=e.navigation,n=e.role,o=e.showNotifications,r=e.unreadCount,a=(0,l.useContext)(m).logout,i=(0,h.default)().width<768;return(0,p.jsxs)(s.default,{style:z.topbar,children:[(0,p.jsxs)(s.default,{style:[z.leftSection,i&&z.leftSectionMobile],children:[(0,p.jsxs)(c.default,{style:[z.brand,i&&z.brandMobile],children:[(0,p.jsx)(c.default,{style:{color:"#0066ff"},children:"Loan"}),"Siya"]}),!i&&(0,p.jsx)(c.default,{style:z.title,children:"Dashboard"})]}),(0,p.jsxs)(s.default,{style:[z.rightSection,i&&z.rightSectionMobile],children:[(0,p.jsx)(c.default,{style:[z.role,i&&z.roleMobile],children:n}),o&&(0,p.jsxs)(f.default,{style:z.notificationContainer,onPress:function(){return t.navigate("LoanOfficerNotifications")},children:[(0,p.jsx)(c.default,{style:[z.icon,i&&z.iconMobile],children:"\ud83d\udd14"}),r>0&&(0,p.jsx)(s.default,{style:z.badge,children:(0,p.jsx)(c.default,{style:z.badgeText,children:r})})]}),(0,p.jsx)(f.default,{onPress:function(){a(),t.replace("Login")},style:[z.logoutButton,i&&z.logoutButtonMobile],children:(0,p.jsx)(c.default,{style:[z.logout,i&&z.logoutMobile],children:"Logout"})})]})]})}var z=g.default.create({topbar:{flexDirection:"row",justifyContent:"space-between",paddingHorizontal:b.default.select({web:"5%",default:16}),paddingVertical:b.default.select({web:15,default:12}),backgroundColor:"#ddd",alignItems:"center",width:"100%"},leftSection:{flexDirection:"row",alignItems:"center",gap:20},leftSectionMobile:{gap:10},rightSection:{flexDirection:"row",alignItems:"center",gap:15},rightSectionMobile:{gap:8},brand:{fontSize:b.default.select({web:22,default:18}),fontWeight:"bold"},brandMobile:{fontSize:16},title:{fontSize:b.default.select({web:20,default:16}),fontWeight:"500"},role:{fontSize:16},roleMobile:{fontSize:12},logoutButton:{padding:b.default.select({web:8,default:12}),backgroundColor:"#f0f0f0",borderRadius:6,minWidth:b.default.select({web:80,default:70})},logoutButtonMobile:{padding:10,minWidth:60},logout:{fontWeight:"bold",color:"#000",textAlign:"center"},logoutMobile:{fontSize:14},notificationContainer:{position:"relative",padding:b.default.select({web:8,default:12})},icon:{fontSize:b.default.select({web:18,default:20})},iconMobile:{fontSize:16},badge:{position:"absolute",top:0,right:0,backgroundColor:"#e74c3c",borderRadius:10,minWidth:20,height:20,justifyContent:"center",alignItems:"center",padding:2},badgeText:{color:"white",fontSize:12,fontWeight:"bold"}});function E(e){var t=e.label,n=e.value,o=e.onPress;return(0,p.jsxs)(s.default,{style:W.card,children:[(0,p.jsx)(c.default,{style:W.label,children:t}),(0,p.jsx)(c.default,{style:W.number,children:n}),o&&(0,p.jsx)(f.default,{style:W.button,onPress:o,children:(0,p.jsx)(c.default,{style:W.buttonText,children:"View List"})})]})}var W=g.default.create({card:{backgroundColor:"#e2e2e2",paddingVertical:b.default.select({web:30,default:20}),paddingHorizontal:b.default.select({web:25,default:15}),borderRadius:12,width:b.default.select({web:200,default:"45%"}),minWidth:b.default.select({web:180,default:150}),alignItems:"center",elevation:3,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4},label:{fontSize:b.default.select({web:16,default:14}),textAlign:"center",marginBottom:b.default.select({web:8,default:6}),color:"#333",fontWeight:"500"},number:{fontSize:b.default.select({web:28,default:24}),fontWeight:"bold",color:"#111",marginBottom:b.default.select({web:14,default:10})},button:{backgroundColor:"#0066ff",paddingVertical:b.default.select({web:10,default:8}),paddingHorizontal:b.default.select({web:30,default:20}),borderRadius:8,width:"90%"},buttonText:{color:"#fff",fontWeight:"bold",fontSize:b.default.select({web:16,default:14}),textAlign:"center"}});function N(e){var t=e.navigation,n=(0,l.useContext)(L).users,o=(0,h.default)().width<768,r=n.filter((function(e){return("LOAN_OFFICER"===e.roleType||"Loan Officer"===e.role)&&"Active"===e.status})).length,a=n.filter((function(e){return("OPS_MANAGER"===e.roleType||"OPS_MANAGER"===e.role)&&"Active"===e.status})).length;return(0,p.jsxs)(s.default,{style:H.container,children:[(0,p.jsx)(I,{navigation:t,role:"IT Admin",showNotifications:!1}),(0,p.jsxs)(s.default,{style:H.content,children:[(0,p.jsxs)(s.default,{style:[H.cardRow,o&&H.cardRowMobile],children:[(0,p.jsx)(E,{label:"Total Active Loan Officers",value:r}),(0,p.jsx)(E,{label:"Total Active Operations Manager",value:a})]}),(0,p.jsx)(f.default,{style:[H.viewListButton,o&&H.viewListButtonMobile],onPress:function(){return t.navigate("UserManagement")},children:(0,p.jsx)(c.default,{style:[H.buttonText,o&&H.buttonTextMobile],children:"View List"})})]})]})}var H=g.default.create({container:{flex:1,backgroundColor:"#f6f6f6"},content:{flex:1,padding:20,alignItems:"center",justifyContent:"center"},cardRow:{flexDirection:"row",gap:20,marginBottom:20,flexWrap:"wrap",justifyContent:"center"},cardRowMobile:{flexDirection:"column",gap:15,alignItems:"center"},viewListButton:{backgroundColor:"#0066ff",paddingVertical:12,paddingHorizontal:40,borderRadius:8,marginTop:20,minWidth:200},viewListButtonMobile:{paddingVertical:14,paddingHorizontal:30,marginTop:25,width:"80%",maxWidth:300},buttonText:{color:"#fff",fontWeight:"600",fontSize:16,textAlign:"center"},buttonTextMobile:{fontSize:15}}),V=n(5458);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,x.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=(0,l.createContext)();function G(e){var t=e.children,n=(0,l.useState)([]),o=(0,d.default)(n,2),r=o[0],a=o[1],s=(0,l.useState)([]),c=(0,d.default)(s,2),u=c[0],f=c[1],g=(0,l.useState)(0),h=(0,d.default)(g,2),b=h[0],m=h[1],y=(0,l.useState)(!0),x=(0,d.default)(y,2),w=x[0],j=x[1],v=(0,l.useState)(null),C=(0,d.default)(v,2),S=C[0],T=C[1];(0,l.useEffect)((function(){P()}),[]),(0,l.useEffect)((function(){A();var e=setInterval((function(){A()}),3e4);return function(){return clearInterval(e)}}),[]);var P=function(){var e=(0,i.default)((function*(){try{j(!0),T(null);var e=yield D.getAllClients();a(e)}catch(t){T("Failed to fetch clients: "+t.message)}finally{j(!1)}}));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,i.default)((function*(e){try{var t=yield D.getClientById(e);return a((function(n){return n.map((function(n){return n.cid===e?t:n}))})),t}catch(n){throw T("Failed to refresh client: "+n.message),n}}));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=(0,i.default)((function*(){try{var e=yield D.notifications.getNotifications();f(e),m(e.filter((function(e){return!e.read})).length)}catch(t){console.error("Failed to fetch notifications:",t)}}));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,i.default)((function*(e){try{yield D.notifications.createNotification(U({timestamp:(new Date).toISOString(),read:!1},e)),yield A()}catch(t){console.error("Failed to create notification:",t)}}));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=(0,i.default)((function*(){try{var e=u.filter((function(e){return!e.read})).map((function(e){return e.id}));e.length>0&&(yield D.notifications.markAsRead(e),yield A())}catch(t){console.error("Failed to mark notifications as read:",t)}}));return function(){return e.apply(this,arguments)}}(),R=function(){var e=(0,i.default)((function*(e,t){try{var n=r.find((function(t){return t.cid===e}));if(!n)throw new Error("Loan not found for CID: "+e);return a((function(n){return n.map((function(n){return n.cid===e?U(U({},n),t):n}))})),"Approved"!==t.status&&"Declined"!==t.status||(yield M({cid:e,clientName:n.name,type:"status_change",status:t.status,message:"Loan request for client "+n.name+" has been "+t.status.toLowerCase()+" by Operations Manager",recipientRole:"loan_officer"})),yield B(e)}catch(o){throw console.error("Failed to update loan:",o),o}}));return function(t,n){return e.apply(this,arguments)}}(),L=function(){var e=(0,i.default)((function*(e,t){try{var n=r.find((function(t){return t.cid===e}));if(!n)throw new Error("Client not found");return yield D.updateLoanAmount(e,t),a((function(n){return n.map((function(n){if(n.cid===e){var o=(0,V.default)(n.loans.loanHistory),l=o.findIndex((function(e,t,n){return new Date(e.dateApplied).getTime()===Math.max.apply(Math,(0,V.default)(n.map((function(e){return new Date(e.dateApplied).getTime()}))))}));return-1!==l&&(o[l]=U(U({},o[l]),{},{amount:t,decidedAt:(new Date).toISOString()})),U(U({},n),{},{loans:U(U({},n.loans),{},{loanHistory:o})})}return n}))})),yield M({cid:e,clientName:n.name,type:"amount_change",amount:t,message:"Loan amount for client "+n.name+" has been updated to \u20b1"+t.toLocaleString()+" by Operations Manager",recipientRole:"loan_officer"}),yield B(e)}catch(o){throw console.error("Failed to update loan amount:",o),o}}));return function(t,n){return e.apply(this,arguments)}}();return(0,p.jsx)(F.Provider,{value:{loans:r,loading:w,error:S,updateLoan:R,updateLoanAmount:L,refreshClientData:B,notifications:u,unreadCount:b,markNotificationsAsRead:O,clearNotifications:function(){f([]),m(0)},fetchNotifications:A},children:t})}function J(){var e=(0,l.useContext)(F);if(!e)throw new Error("useLoan must be used within a LoanProvider");return e}function q(e){var t=e.navigation,n=J().loans,o=(0,h.default)().width<768,l=n.length,r=n.filter((function(e){return"Pending"===e.status||!e.status})).length;return(0,p.jsxs)(s.default,{style:K.container,children:[(0,p.jsx)(I,{navigation:t,role:"Operations Manager",showNotifications:!1}),(0,p.jsx)(s.default,{style:[K.content,o&&K.contentMobile],children:(0,p.jsxs)(s.default,{style:[K.cardRow,o&&K.cardRowMobile],children:[(0,p.jsx)(E,{label:"Total Loan Clients",value:l,onPress:function(){return t.navigate("OpsClientList")}}),(0,p.jsx)(E,{label:"Total Loan Pending",value:r,onPress:function(){return t.navigate("OpsPendingList")}})]})})]})}var K=g.default.create({container:{flex:1,backgroundColor:"#f6f6f6"},content:{flex:1,padding:b.default.select({web:40,default:20}),alignItems:"center",justifyContent:"center"},contentMobile:{padding:16},cardRow:{flexDirection:"row",gap:b.default.select({web:30,default:15}),flexWrap:"wrap",justifyContent:"center",maxWidth:1200,width:"100%"},cardRowMobile:{gap:12,paddingHorizontal:10}});function X(e){var t=e.navigation,n=J(),o=n.loans,l=n.unreadCount,r=(0,h.default)().width<768,a=o.length;o.filter((function(e){return"Pending"===e.status||!e.status})).length;return(0,p.jsxs)(s.default,{style:Y.container,children:[(0,p.jsx)(I,{navigation:t,role:"Loan Officer",showNotifications:!0,unreadCount:l}),(0,p.jsx)(s.default,{style:[Y.content,r&&Y.contentMobile],children:(0,p.jsxs)(s.default,{style:[Y.cardRow,r&&Y.cardRowMobile],children:[(0,p.jsx)(E,{label:"Total Loan Client",value:a,onPress:function(){return t.navigate("ClientList")}}),(0,p.jsx)(E,{label:"Total Loan List",value:a,onPress:function(){return t.navigate("TotalLoanList")}})]})})]})}var Y=g.default.create({container:{flex:1,backgroundColor:"#f6f6f6"},content:{flex:1,padding:b.default.select({web:40,default:20}),alignItems:"center",justifyContent:"center"},contentMobile:{padding:16},cardRow:{flexDirection:"row",gap:b.default.select({web:30,default:15}),flexWrap:"wrap",justifyContent:"center",maxWidth:1200,width:"100%"},cardRowMobile:{gap:12,paddingHorizontal:10}}),Q=n(1218),Z=n(530),$={container:{flexGrow:1,width:"100%",backgroundColor:"#f6f6f6",padding:b.default.select({web:24,default:16})},containerDesktop:{minHeight:"100vh",justifyContent:"center",paddingVertical:40},content:{flexDirection:"row",padding:b.default.select({web:20,default:16}),width:"100%",maxWidth:1400,alignSelf:"center"},contentMobile:{flexDirection:"column"},section:{flex:1,padding:b.default.select({web:20,default:16}),backgroundColor:"#fff",marginHorizontal:b.default.select({web:10,default:8}),marginVertical:b.default.select({web:0,default:8}),borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},sectionMobile:{padding:12,marginBottom:20,marginHorizontal:0},centerContent:{justifyContent:"center",alignItems:"center"},loadingText:{marginTop:10,fontSize:b.default.select({web:16,default:14}),color:"#666"},errorText:{color:"#dc3545",fontSize:b.default.select({web:16,default:14}),marginBottom:15,textAlign:"center"},title:{fontSize:b.default.select({web:22,default:20}),fontWeight:"bold",color:"#333"},titleMobile:{fontSize:18},button:{primaryButton:{backgroundColor:"#007bff",paddingVertical:b.default.select({web:10,default:8}),paddingHorizontal:b.default.select({web:16,default:12}),borderRadius:8,alignItems:"center",justifyContent:"center"},secondaryButton:{backgroundColor:"#e9ecef",paddingVertical:b.default.select({web:10,default:8}),paddingHorizontal:b.default.select({web:16,default:12}),borderRadius:8,alignItems:"center",justifyContent:"center"},buttonText:{color:"#fff",fontSize:b.default.select({web:16,default:14}),fontWeight:"600",textAlign:"center"},buttonTextSecondary:{color:"#333",fontSize:b.default.select({web:16,default:14}),fontWeight:"600",textAlign:"center"}},modal:{overlay:{flex:1,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center"},content:{backgroundColor:"white",padding:b.default.select({web:24,default:16}),borderRadius:12,width:"80%",maxWidth:500,maxHeight:"80%"},contentMobile:{width:"90%",padding:16},title:{fontSize:b.default.select({web:18,default:16}),fontWeight:"bold",marginBottom:15,textAlign:"center",color:"#333"}},searchBar:{container:{flexDirection:"row",marginBottom:b.default.select({web:16,default:12})},input:{backgroundColor:"#fff",borderRadius:8,padding:b.default.select({web:12,default:10}),flex:1,fontSize:b.default.select({web:16,default:14}),borderWidth:1,borderColor:"#ddd"},inputMobile:{padding:8,fontSize:14}},header:{marginBottom:b.default.select({web:24,default:16})},titleContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:b.default.select({web:20,default:16})}};function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(Object(n),!0).forEach((function(t){(0,x.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ne(e){var t=e.navigation,n=e.userRole,o=void 0===n?"loanofficer":n,r=e.onClientPress,a=e.dashboardRoute,i=(0,h.default)().width<768,g=(0,l.useState)(""),b=(0,d.default)(g,2),m=b[0],y=b[1],x=J(),w=x.loans,j=x.loading,v=x.error,C=w.filter((function(e){return e.name.toLowerCase().includes(m.toLowerCase())||e.cid.includes(m)})),S=function(e){if(r)r(e);else{var n="ops"===o?"OpsClientProfile":"ClientProfile";t.navigate(n,{client:te(te({},e),{},{cid:e.cid,name:e.name||"N/A",age:e.age||0,email:e.email||"N/A",number:e.number||"N/A",address:e.address||"N/A",financial:e.financial||{monthlyIncome:0,monthlyExpenses:0,assets:0,dti:0}})})}};return j?(0,p.jsxs)(s.default,{style:[$.container,$.centerContent],children:[(0,p.jsx)(Z.default,{size:"large",color:"#0066ff"}),(0,p.jsx)(c.default,{style:$.loadingText,children:"Loading clients..."})]}):v?(0,p.jsx)(s.default,{style:[$.container,$.centerContent],children:(0,p.jsx)(c.default,{style:$.errorText,children:v})}):(0,p.jsxs)(s.default,{style:$.container,children:[(0,p.jsxs)(s.default,{style:oe.header,children:[(0,p.jsxs)(s.default,{style:oe.titleContainer,children:[(0,p.jsx)(c.default,{style:[$.title,i&&$.titleMobile],children:"Client List"}),(0,p.jsx)(f.default,{style:[oe.dashboardBtn,i&&oe.dashboardBtnMobile],onPress:function(){return t.navigate(a)},children:(0,p.jsx)(c.default,{style:[oe.btnText,i&&oe.btnTextMobile],children:"Go to Dashboard"})})]}),(0,p.jsx)(s.default,{style:[$.searchBar.container,i&&oe.searchBarMobile],children:(0,p.jsx)(u.default,{style:[$.searchBar.input,i&&$.searchBar.inputMobile],placeholder:"Search by name or CID",value:m,onChangeText:y})})]}),!i&&(0,p.jsx)(s.default,{style:oe.tableHeader,children:(0,p.jsxs)(s.default,{style:oe.rowContent,children:[(0,p.jsx)(c.default,{style:[oe.headerCell,oe.cidCell],children:"CID"}),(0,p.jsx)(c.default,{style:[oe.headerCell,oe.nameCell],children:"Full Name"}),(0,p.jsx)(s.default,{style:oe.actionCell,children:(0,p.jsx)(c.default,{style:oe.headerCell})})]})}),(0,p.jsx)(Q.default,{data:C,keyExtractor:function(e){return e.cid},renderItem:function(e){var t=e.item;return(0,p.jsx)(f.default,{style:[oe.row,i&&oe.rowMobile],onPress:function(){return i&&S(t)},children:i?(0,p.jsxs)(s.default,{style:oe.mobileContent,children:[(0,p.jsx)(c.default,{style:oe.mobileName,children:t.name}),(0,p.jsxs)(c.default,{style:oe.mobileCid,children:["CID: ",t.cid]})]}):(0,p.jsxs)(s.default,{style:oe.rowContent,children:[(0,p.jsx)(c.default,{style:[oe.cell,oe.cidCell],children:t.cid}),(0,p.jsx)(c.default,{style:[oe.cell,oe.nameCell],children:t.name}),(0,p.jsx)(s.default,{style:oe.actionCell,children:(0,p.jsx)(f.default,{style:oe.viewBtn,onPress:function(){return S(t)},children:(0,p.jsx)(c.default,{style:oe.viewBtnText,children:"View"})})})]})})},ListEmptyComponent:function(){return(0,p.jsx)(s.default,{style:oe.emptyContainer,children:(0,p.jsx)(c.default,{style:oe.emptyText,children:m?"No clients match your search":"No clients found"})})}})]})}var oe=g.default.create({header:{marginBottom:20},titleContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:b.default.select({web:20,default:16})},dashboardBtn:{backgroundColor:"#0066ff",paddingVertical:b.default.select({web:10,default:8}),paddingHorizontal:b.default.select({web:16,default:12}),borderRadius:8},dashboardBtnMobile:{paddingVertical:8,paddingHorizontal:12},btnText:{color:"#fff",fontWeight:"600",fontSize:b.default.select({web:16,default:14})},btnTextMobile:{fontSize:14},searchBarMobile:{marginBottom:10},tableHeader:{flexDirection:"row",backgroundColor:"#e9ecef",paddingVertical:12,paddingHorizontal:b.default.select({web:16,default:12}),marginBottom:4,borderRadius:8,alignItems:"flex-start"},headerCell:{fontWeight:"bold",fontSize:16,color:"#495057"},row:{flexDirection:"row",backgroundColor:"#fff",paddingVertical:b.default.select({web:12,default:10}),paddingHorizontal:b.default.select({web:16,default:12}),marginBottom:8,borderRadius:8,alignItems:"flex-start",borderWidth:1,borderColor:"#e9ecef"},rowMobile:{padding:12},rowContent:{flexDirection:"row",flex:1,alignItems:"center"},cell:{paddingHorizontal:6,fontSize:b.default.select({web:16,default:14}),color:"#212529"},cidCell:{width:"25%",textAlign:"left"},nameCell:{width:"50%",textAlign:"left"},actionCell:{width:"25%",alignItems:"flex-end"},mobileContent:{flex:1},mobileName:{fontSize:16,fontWeight:"500",marginBottom:4,color:"#212529"},mobileCid:{fontSize:14,color:"#6c757d"},viewBtn:{backgroundColor:"#e9ecef",paddingVertical:8,paddingHorizontal:16,borderRadius:6},viewBtnText:{color:"#495057",fontSize:14,fontWeight:"500"},emptyContainer:{padding:b.default.select({web:20,default:16}),alignItems:"center"},emptyText:{fontSize:b.default.select({web:16,default:14}),color:"#6c757d"}});function le(e){var t=e.navigation;return(0,p.jsx)(ne,{navigation:t,userRole:"loanofficer",dashboardRoute:"LoanOfficerDashboard"})}var re=n(368),ae=n(8264),ie=function(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})};function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){(0,x.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=function(){var e=(0,i.default)((function*(e){try{var t=yield D.getDocumentDates(e),n=[];for(var o of t){var l=(yield D.getDocumentsByDate(e,o.date)).filter((function(e){return!["pdf","signed-promissory-note"].some((function(t){return e.type.includes(t)||e.name.toLowerCase().includes(t)||e.displayName.toLowerCase().includes(t)}))}));l.length>0&&n.push(se(se({},o),{},{documentCount:l.length}))}return n}catch(r){throw console.error("Error loading document dates:",r),new Error("Failed to load document dates")}}));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=(0,i.default)((function*(e){try{var t=yield D.getDocumentDates(e),n=[];for(var o of t){var l=(yield D.getDocumentsByDate(e,o.date)).filter((function(e){var t=(e.name||"").toLowerCase(),n=(e.displayName||"").toLowerCase(),o=(e.type||"").toLowerCase().includes("pdf")||t.endsWith(".pdf")||n.endsWith(".pdf"),l=t.includes("signed-promissory-note")||n.includes("signed-promissory note");return o||l}));l.length>0&&n.push(se(se({},o),{},{documentCount:l.length}))}return n}catch(r){throw console.error("Error loading signed document dates:",r),new Error("Failed to load signed document dates")}}));return function(t){return e.apply(this,arguments)}}(),fe=function(){var e=(0,i.default)((function*(e,t){try{return(yield D.getDocumentsByDate(e,t)).filter((function(e){return!["pdf","signed-promissory-note"].some((function(t){return e.type.includes(t)||e.name.toLowerCase().includes(t)||e.displayName.toLowerCase().includes(t)}))}))}catch(n){throw console.error("Error loading documents:",n),new Error("Failed to load application documents")}}));return function(t,n){return e.apply(this,arguments)}}(),ge=function(){var e=(0,i.default)((function*(e,t){try{return(yield D.getDocumentsByDate(e,t)).filter((function(e){var t=(e.name||"").toLowerCase(),n=(e.displayName||"").toLowerCase(),o=(e.type||"").toLowerCase().includes("pdf")||t.endsWith(".pdf")||n.endsWith(".pdf"),l=t.includes("signed-promissory-note")||n.includes("signed-promissory note");return o||l}))}catch(n){throw console.error("Error loading signed documents:",n),new Error("Failed to load signed documents")}}));return function(t,n){return e.apply(this,arguments)}}();function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){(0,x.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pe={name:"N/A",age:0,cid:"",email:"N/A",number:"N/A",address:"N/A",documents:{applicationDocs:B.APPLICATION_DOCS,signedDocuments:[]},financial:{monthlyIncome:0,monthlyExpenses:0,assets:0,dti:0},employer:"N/A",position:"N/A"};function me(e){var t,n,o=e.navigation,r=e.route,a=e.userRole,u=void 0===a?"loanofficer":a,g=(0,h.default)().width<768,b=(0,l.useState)(null),m=(0,d.default)(b,2),y=m[0],x=m[1],w=(0,l.useState)(!0),j=(0,d.default)(w,2),v=j[0],C=j[1],S=(0,l.useState)(null),T=(0,d.default)(S,2),P=T[0],B=T[1],D=(0,l.useState)(!1),A=(0,d.default)(D,2),M=A[0],O=A[1],R=(0,l.useState)([]),L=(0,d.default)(R,2),k=L[0],I=L[1],z=(0,l.useState)(!1),E=(0,d.default)(z,2),W=E[0],N=E[1],H=(0,l.useState)("application"),V=(0,d.default)(H,2),_=V[0],U=V[1],F=J().refreshClientData,G=null==(t=r.params)||null==(n=t.client)?void 0:n.cid;(0,l.useEffect)((function(){G&&q()}),[G]);var q=function(){var e=(0,i.default)((function*(){try{var e,t;C(!0),B(null);var n=yield F(G),o={applicationDocs:(null==(e=n.documents)?void 0:e.applicationDocs)||pe.documents.applicationDocs,signedDocuments:(null==(t=n.documents)?void 0:t.signedDocuments)||[]};x(be(be(be({},pe),n),{},{documents:o}))}catch(l){console.error("Error loading client:",l),B("Failed to load client data. Please try again.")}finally{C(!1)}}));return function(){return e.apply(this,arguments)}}(),K=function(){var e=(0,i.default)((function*(e){try{N(!0),U(e);var t="application"===e?yield ce(G):yield ue(G);I(t),O(!0)}catch(P){alert("Error loading "+e+" document dates. Please try again.")}finally{N(!1)}}));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=(0,i.default)((function*(e){try{O(!1);var t="application"===_?yield fe(y.cid,e):yield ge(y.cid,e);t.length>0?o.navigate("DocumentPreview",{cid:y.cid,title:("application"===_?"Application":"Signed")+" Documents - "+ie(e),documents:t,latestDate:e}):alert("No "+_+" documents found for the selected date")}catch(P){alert("Error loading "+_+" documents. Please try again.")}}));return function(t){return e.apply(this,arguments)}}();return v?(0,p.jsxs)(s.default,{style:[$.container,$.centerContent],children:[(0,p.jsx)(Z.default,{size:"large",color:"#0066ff"}),(0,p.jsx)(c.default,{style:$.loadingText,children:"Loading client data..."})]}):P?(0,p.jsxs)(s.default,{style:[$.container,$.centerContent],children:[(0,p.jsx)(c.default,{style:$.errorText,children:P}),(0,p.jsx)(f.default,{style:ye.retryBtn,onPress:q,children:(0,p.jsx)(c.default,{style:ye.retryText,children:"Retry"})})]}):y?(0,p.jsxs)(re.default,{style:ye.scrollView,contentContainerStyle:[$.container,!g&&$.containerDesktop],children:[(0,p.jsxs)(s.default,{style:[$.content,g&&$.contentMobile],children:[(0,p.jsxs)(s.default,{style:[$.section,g&&$.sectionMobile],children:[(0,p.jsx)(c.default,{style:ye.sectionTitle,children:"Client Profile"}),(0,p.jsx)(c.default,{style:ye.subTitle,children:"Personal Details"}),(0,p.jsxs)(s.default,{style:ye.detailsContainer,children:[(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:ye.bold,children:"Name:"})," ",y.name]}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:ye.bold,children:"Age:"})," ",y.age]}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:ye.bold,children:"CID:"})," ",y.cid]}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:ye.bold,children:"Email:"})," ",y.email]}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:ye.bold,children:"Number:"})," ",y.number]}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:ye.bold,children:"Address:"})," ",y.address]})]}),(0,p.jsx)(c.default,{style:[ye.subTitle,{marginTop:16}],children:"Uploaded Documents"}),(0,p.jsxs)(s.default,{style:ye.documentCategory,children:[(0,p.jsx)(c.default,{style:ye.categoryText,children:"Application Documents"}),(0,p.jsx)(f.default,{style:ye.previewBtn,onPress:function(){return K("application")},disabled:W,children:(0,p.jsx)(c.default,{style:ye.previewText,children:W?"Loading...":"View"})})]}),(0,p.jsxs)(s.default,{style:ye.documentCategory,children:[(0,p.jsx)(c.default,{style:ye.categoryText,children:"Signed Documents"}),(0,p.jsx)(f.default,{style:ye.previewBtn,onPress:function(){return K("signed")},disabled:W,children:(0,p.jsx)(c.default,{style:ye.previewText,children:W?"Loading...":"View"})})]})]}),(0,p.jsxs)(s.default,{style:[$.section,g&&$.sectionMobile],children:[(0,p.jsxs)(s.default,{style:ye.financialContainer,children:[(0,p.jsx)(c.default,{style:ye.sectionTitle,children:"Financial Record"}),(0,p.jsxs)(s.default,{style:ye.financialDetails,children:[(0,p.jsxs)(c.default,{style:ye.financialItem,children:["Monthly Income \u20b1",y.financial.monthlyIncome.toLocaleString()]}),(0,p.jsxs)(c.default,{style:ye.financialItem,children:["Monthly Expenses \u20b1",y.financial.monthlyExpenses.toLocaleString()]}),(0,p.jsxs)(c.default,{style:ye.financialItem,children:["Saving and Assets \u20b1",y.financial.assets.toLocaleString()]}),(0,p.jsxs)(c.default,{style:ye.financialItem,children:["Debt to Income Ratio ",y.financial.dti,"%"]})]})]}),(0,p.jsxs)(s.default,{style:ye.employmentContainer,children:[(0,p.jsx)(c.default,{style:[ye.sectionTitle,{marginTop:16}],children:"Employment or Business info"}),(0,p.jsxs)(s.default,{style:ye.employmentDetails,children:[(0,p.jsx)(c.default,{style:ye.employmentItem,children:y.employer}),(0,p.jsx)(c.default,{style:ye.employmentItem,children:y.position})]})]}),(0,p.jsxs)(s.default,{style:ye.loanHistoryContainer,children:[(0,p.jsx)(c.default,{style:[ye.sectionTitle,{marginTop:16}],children:"Loan History"}),(0,p.jsx)(f.default,{style:ye.viewBtn,onPress:function(){return o.navigate("LoanHistory",{clientId:y.cid,userRole:u})},children:(0,p.jsx)(c.default,{style:ye.viewBtnText,children:"View History"})})]}),(0,p.jsxs)(s.default,{style:ye.actionRow,children:[(0,p.jsx)(f.default,{style:ye.backBtn,onPress:function(){return o.goBack()},children:(0,p.jsx)(c.default,{style:ye.backBtnText,children:"\u2190 Back to List"})}),(0,p.jsx)(f.default,{style:ye.refreshBtn,onPress:q,children:(0,p.jsx)(c.default,{style:ye.actionBtnText,children:"\u21bb Refresh"})})]})]})]}),(0,p.jsx)(ae.default,{visible:M,transparent:!0,animationType:"fade",onRequestClose:function(){return O(!1)},children:(0,p.jsx)(s.default,{style:$.modal.overlay,children:(0,p.jsxs)(s.default,{style:[$.modal.content,g&&$.modal.contentMobile],children:[(0,p.jsxs)(c.default,{style:$.modal.title,children:["Select ","application"===_?"Application":"Signed"," Document Date"]}),k.length>0?k.map((function(e,t){return(0,p.jsxs)(f.default,{style:ye.dateButton,onPress:function(){return X(e.date)},children:[(0,p.jsxs)(c.default,{style:ye.dateButtonText,children:["\ud83d\udcc5 ",ie(e.date)]}),(0,p.jsxs)(c.default,{style:ye.documentCountText,children:["(",e.documentCount," documents)"]})]},t)})):(0,p.jsx)(c.default,{style:ye.noDataText,children:"No document dates found"}),(0,p.jsx)(f.default,{style:ye.closeButton,onPress:function(){return O(!1)},children:(0,p.jsx)(c.default,{style:ye.closeButtonText,children:"Cancel"})})]})})})]}):(0,p.jsxs)(s.default,{style:[$.container,$.centerContent],children:[(0,p.jsx)(c.default,{style:$.errorText,children:"Client not found"}),(0,p.jsx)(f.default,{style:ye.backBtn,onPress:function(){return o.goBack()},children:(0,p.jsx)(c.default,{style:ye.backBtnText,children:"\u2190 Back to List"})})]})}var ye=g.default.create({scrollView:{flex:1},sectionTitle:{fontWeight:"bold",fontSize:b.default.select({web:18,default:16}),marginBottom:10,color:"#333"},subTitle:{fontWeight:"bold",fontSize:b.default.select({web:16,default:14}),marginTop:10,marginBottom:6,color:"#444"},detailsContainer:{backgroundColor:"#fff",padding:b.default.select({web:16,default:12}),borderRadius:8,marginTop:8,gap:8},bold:{fontWeight:"bold"},documentCategory:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"#f5f5f5",padding:b.default.select({web:16,default:12}),marginVertical:8,borderRadius:8,borderWidth:1,borderColor:"#e0e0e0"},categoryText:{fontSize:b.default.select({web:15,default:14}),color:"#333",fontWeight:"500"},financialContainer:{marginBottom:16},financialDetails:{backgroundColor:"#f8f9fa",padding:12,borderRadius:8,gap:8},financialItem:{fontSize:b.default.select({web:15,default:14}),color:"#333",paddingVertical:2},employmentContainer:{marginBottom:16},employmentDetails:{backgroundColor:"#f8f9fa",padding:12,borderRadius:8,gap:6,marginTop:8},employmentItem:{fontSize:b.default.select({web:15,default:14}),color:"#333",paddingVertical:2},loanHistoryContainer:{marginBottom:20},viewBtn:be(be({},$.button.primaryButton),{},{marginTop:8}),viewBtnText:be({},$.button.buttonText),actionRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:20,gap:10,flexWrap:"wrap"},backBtn:be(be({},$.button.secondaryButton),{},{flex:1,maxWidth:b.default.select({web:"auto",default:"48%"}),alignItems:"center"}),refreshBtn:{backgroundColor:"#28a745",paddingVertical:b.default.select({web:10,default:10}),paddingHorizontal:b.default.select({web:16,default:16}),borderRadius:8,flex:1,maxWidth:b.default.select({web:"auto",default:"48%"}),alignItems:"center"},backBtnText:be({},$.button.buttonTextSecondary),actionBtnText:be({},$.button.buttonText),dateButton:{backgroundColor:"#f8f9fa",padding:b.default.select({web:15,default:12}),borderRadius:8,marginBottom:8,borderWidth:1,borderColor:"#e9ecef",flexDirection:"row",justifyContent:"space-between",alignItems:"center"},dateButtonText:{fontSize:b.default.select({web:16,default:14}),color:"#333",fontWeight:"500"},documentCountText:{fontSize:b.default.select({web:14,default:12}),color:"#666",fontStyle:"italic"},noDataText:{textAlign:"center",color:"#666",fontSize:16,marginVertical:20},previewBtn:{backgroundColor:"#0066ff",paddingVertical:b.default.select({web:8,default:6}),paddingHorizontal:b.default.select({web:16,default:12}),borderRadius:6},previewText:{color:"#fff",fontSize:b.default.select({web:14,default:12}),fontWeight:"500"},closeButton:{backgroundColor:"#dc3545",padding:b.default.select({web:12,default:10}),borderRadius:8,marginTop:15},closeButtonText:{textAlign:"center",fontWeight:"bold",color:"white",fontSize:b.default.select({web:16,default:14})},retryBtn:{backgroundColor:"#0066ff",paddingVertical:8,paddingHorizontal:20,borderRadius:6},retryText:{color:"#fff",fontWeight:"bold"}});function xe(e){var t=e.navigation,n=e.route;return(0,p.jsx)(me,{navigation:t,route:n,userRole:"loanofficer"})}var we=n(2996),je=["Pending","Approved","Declined"];function ve(e){var t=e.navigation,n=(e.route,(0,l.useState)("")),o=(0,d.default)(n,2),r=o[0],a=o[1],g=(0,l.useState)("Pending"),b=(0,d.default)(g,2),m=b[0],y=b[1],x=(0,l.useState)(!1),w=(0,d.default)(x,2),j=w[0],v=w[1],C=J(),S=C.loans,T=C.refreshClientData,P=C.notifications,B=function(){var e=(0,i.default)((function*(){v(!0);try{yield Promise.all(S.map((function(e){return T(e.cid)})))}catch(e){console.error("Error refreshing loans:",e)}finally{v(!1)}}));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){return t.addListener("focus",B)}),[t,S]),(0,l.useEffect)((function(){B()}),[]);var D=function(e){var t=new Date(e);return["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()]+" "+t.getDate()+", "+t.getFullYear()},A=function(e){var t,n=P.filter((function(t){return t.cid===e.cid&&("status_change"===t.type||"amount_change"===t.type)})).sort((function(e,t){return new Date(t.timestamp)-new Date(e.timestamp)}));if(n.length>0){var o=n[0];return D(o.timestamp)+" ("+(o.status||"Amount updated")+" by Ops Manager)"}if(null!=(t=e.loans)&&t.loanHistory&&e.loans.loanHistory.length>0){var l=(0,V.default)(e.loans.loanHistory).sort((function(e,t){return new Date(t.dateUpdated||t.dateApplied)-new Date(e.dateUpdated||e.dateApplied)}))[0],r=l.dateUpdated||l.dateApplied;return""+D(r)+(l.status?" ("+l.status+")":"")}return"No date"},M=S.filter((function(e){var t=e.name.toLowerCase().includes(r.toLowerCase())||e.cid.includes(r),n=e.status?e.status.toLowerCase():"pending",o=m.toLowerCase(),l="pending"===o&&(!e.status||"pending"===n)||n===o;return t&&l})),O=(0,h.default)().width,R=O<600,L=O>=600&&O<1024;return(0,p.jsxs)(s.default,{style:Ce.container,children:[(0,p.jsxs)(s.default,{style:[Ce.header,R&&Ce.headerMobile],children:[(0,p.jsx)(c.default,{style:[Ce.title,R&&Ce.titleMobile],children:"Total Loan List"}),(0,p.jsx)(f.default,{style:[Ce.dashboardBtn,R&&Ce.dashboardBtnMobile],onPress:function(){return t.navigate("LoanOfficerDashboard")},children:(0,p.jsx)(c.default,{style:[Ce.btnText,R&&Ce.btnTextMobile],children:"Go to Dashboard"})})]}),(0,p.jsxs)(s.default,{style:[Ce.searchFilterRow,R&&Ce.searchFilterRowMobile],children:[(0,p.jsx)(u.default,{style:[Ce.searchInput,R&&Ce.searchInputMobile],placeholder:"Search by name or CID",value:r,onChangeText:a}),(0,p.jsxs)(s.default,{style:[Ce.filter,R&&Ce.filterMobile],children:[(0,p.jsx)(c.default,{style:[Ce.filterLabel,R&&Ce.filterLabelMobile],children:"Filter:"}),je.map((function(e){return(0,p.jsx)(we.default,{style:[Ce.filterOption,m===e&&Ce.activeFilter,R&&Ce.filterOptionMobile],onPress:function(){return y(e)},children:(0,p.jsx)(c.default,{style:[Ce.filterText,m===e&&Ce.activeFilterText,R&&Ce.filterTextMobile],children:e})},e)}))]})]}),!R&&(0,p.jsxs)(s.default,{style:Ce.tableHeader,children:[(0,p.jsx)(s.default,{style:[Ce.headerContainer,L?Ce.tabletCell:{flex:1},Ce.cidCell],children:(0,p.jsx)(c.default,{style:[Ce.headerCell,L&&Ce.tabletHeaderText],children:"CID"})}),(0,p.jsx)(s.default,{style:[Ce.headerContainer,L?Ce.tabletCell:{flex:3},Ce.nameCell],children:(0,p.jsx)(c.default,{style:[Ce.headerCell,L&&Ce.tabletHeaderText],children:"Full Name"})}),(0,p.jsx)(s.default,{style:[Ce.headerContainer,L?Ce.tabletCell:{flex:2},Ce.statusCell],children:(0,p.jsx)(c.default,{style:[Ce.headerCell,Ce.centerText,L&&Ce.tabletHeaderText],children:"Loan Status"})}),(0,p.jsx)(s.default,{style:[Ce.headerContainer,L?Ce.tabletCell:{flex:2},Ce.updateCell],children:(0,p.jsx)(c.default,{style:[Ce.headerCell,L&&Ce.tabletHeaderText],children:"Latest Update"})}),(0,p.jsx)(s.default,{style:[Ce.headerContainer,L?Ce.tabletCell:{flex:1},Ce.actionCell],children:(0,p.jsx)(c.default,{style:[Ce.headerCell,L&&Ce.tabletHeaderText]})})]}),j&&(0,p.jsx)(s.default,{style:Ce.refreshingIndicator,children:(0,p.jsx)(c.default,{style:Ce.refreshingText,children:"Refreshing loan data..."})}),(0,p.jsx)(Q.default,{data:M,keyExtractor:function(e){return e.cid},renderItem:function(e){var n=e.item;return(0,p.jsx)(f.default,{style:[Ce.row,R&&Ce.rowMobile,L&&Ce.rowTablet],onPress:function(){return R&&t.navigate("PendingLoanDetail",{client:n,backScreen:"TotalLoanList"})},children:R?(0,p.jsxs)(s.default,{style:Ce.mobileContent,children:[(0,p.jsx)(c.default,{style:Ce.mobileName,children:n.name}),(0,p.jsxs)(c.default,{style:Ce.mobileCid,children:["CID: ",n.cid]}),(0,p.jsxs)(s.default,{style:Ce.mobileStatusRow,children:[(0,p.jsxs)(c.default,{style:[Ce.mobileStatus,n.status&&"approved"===n.status.toLowerCase()&&Ce.approvedStatus,n.status&&"declined"===n.status.toLowerCase()&&Ce.declinedStatus,(!n.status||"pending"===n.status.toLowerCase())&&Ce.pendingStatus],children:["Status: ",n.status?n.status.charAt(0).toUpperCase()+n.status.slice(1).toLowerCase():"Pending"]}),(0,p.jsxs)(c.default,{style:Ce.mobileDate,children:["Latest Updated: ",A(n)]})]})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(s.default,{style:[Ce.cellContainer,L?Ce.tabletCell:{flex:1},Ce.cidCell],children:(0,p.jsx)(c.default,{style:Ce.cell,numberOfLines:1,children:n.cid})}),(0,p.jsx)(s.default,{style:[Ce.cellContainer,L?Ce.tabletCell:{flex:3},Ce.nameCell],children:(0,p.jsx)(c.default,{style:Ce.cell,numberOfLines:1,children:n.name})}),(0,p.jsx)(s.default,{style:[Ce.cellContainer,L?Ce.tabletCell:{flex:2},Ce.statusCell],children:(0,p.jsx)(c.default,{style:[Ce.cell,Ce.centerText,n.status&&"approved"===n.status.toLowerCase()&&Ce.approvedStatus,n.status&&"declined"===n.status.toLowerCase()&&Ce.declinedStatus,(!n.status||"pending"===n.status.toLowerCase())&&Ce.pendingStatus],numberOfLines:1,children:n.status?n.status.charAt(0).toUpperCase()+n.status.slice(1).toLowerCase():"Pending"})}),(0,p.jsx)(s.default,{style:[Ce.cellContainer,L?Ce.tabletCell:{flex:2},Ce.updateCell],children:(0,p.jsx)(c.default,{style:[Ce.cell,L&&Ce.tabletUpdateText],children:A(n)})}),(0,p.jsx)(s.default,{style:[Ce.cellContainer,L?Ce.tabletCell:{flex:1},Ce.actionCell],children:(0,p.jsx)(f.default,{style:Ce.viewBtn,onPress:function(){return t.navigate("PendingLoanDetail",{client:n,backScreen:"TotalLoanList"})},children:(0,p.jsx)(c.default,{style:Ce.viewBtnText,children:"View"})})})]})})}})]})}var Ce=g.default.create({rowTablet:{paddingVertical:16},tabletCell:{paddingHorizontal:8},tabletUpdateText:{fontSize:13,lineHeight:18,flexWrap:"wrap",textAlign:"left",paddingRight:4,width:"100%"},cidCell:{width:"15%"},nameCell:{width:"25%"},statusCell:{width:"15%"},updateCell:{width:"35%",paddingRight:12},actionCell:{width:"10%",alignItems:"center"},headerMobile:{flexDirection:"column",gap:12,alignItems:"flex-start",marginBottom:16},titleMobile:{fontSize:18},dashboardBtnMobile:{paddingVertical:8,paddingHorizontal:12},btnTextMobile:{fontSize:14},searchFilterRowMobile:{flexDirection:"column",gap:12},searchInputMobile:{minWidth:"100%",padding:8,fontSize:14},filterMobile:{flexWrap:"wrap",gap:8},filterLabelMobile:{fontSize:14},filterOptionMobile:{paddingVertical:4,paddingHorizontal:8},filterTextMobile:{fontSize:12},rowMobile:{padding:12,marginBottom:8,backgroundColor:"#fff",borderRadius:8,borderWidth:1,borderColor:"#e9ecef"},mobileContent:{flex:1},mobileName:{fontSize:16,fontWeight:"500",marginBottom:4,color:"#212529"},mobileCid:{fontSize:14,color:"#6c757d",marginBottom:6},mobileStatusRow:{flexDirection:"column",gap:8},mobileStatus:{fontSize:14,fontWeight:"500"},mobileDate:{fontSize:12,color:"#6c757d",flexWrap:"wrap"},viewBtnText:{color:"#495057",fontSize:14,fontWeight:"500"},cellContainer:{paddingHorizontal:10,justifyContent:"center",alignItems:"center"},headerContainer:{paddingHorizontal:10,justifyContent:"center",alignItems:"center"},centerText:{textAlign:"center",width:"100%"},container:{padding:b.default.select({web:20,default:16}),backgroundColor:"#f6f6f6",flex:1},approvedStatus:{color:"#2ecc71",fontWeight:"bold"},pendingStatus:{color:"#000000",fontWeight:"bold"},declinedStatus:{color:"#e74c3c",fontWeight:"bold"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},title:{fontSize:22,fontWeight:"bold"},dashboardBtn:{backgroundColor:"#007AFF",paddingVertical:8,paddingHorizontal:16,borderRadius:6},btnText:{color:"#fff",fontWeight:"600"},searchFilterRow:{flexDirection:"row",justifyContent:"space-between",gap:10,marginBottom:10,flexWrap:"wrap"},searchInput:{backgroundColor:"#ddd",borderRadius:6,padding:10,flex:1,minWidth:150},filter:{flexDirection:"row",alignItems:"center",gap:6},filterLabel:{fontWeight:"600"},filterOption:{backgroundColor:"#eee",paddingVertical:6,paddingHorizontal:12,borderRadius:6},activeFilter:{backgroundColor:"#007AFF"},filterText:{color:"#000"},activeFilterText:{color:"#fff",fontWeight:"bold"},refreshingIndicator:{padding:10,backgroundColor:"#e8f5e9",marginBottom:10},refreshingText:{color:"#2ecc71",textAlign:"center"},tableHeader:{flexDirection:"row",backgroundColor:"#dcdcdc",paddingVertical:10,marginBottom:4,alignItems:"center"},headerCell:{fontWeight:"bold",fontSize:15},row:{flexDirection:"row",paddingVertical:12,borderBottomWidth:1,borderColor:"#ccc",alignItems:"center",minHeight:50},cell:{fontSize:14},viewBtn:{backgroundColor:"#ccc",paddingVertical:6,paddingHorizontal:16,borderRadius:6}});function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(n),!0).forEach((function(t){(0,x.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pe={name:"N/A",age:0,cid:"",email:"N/A",number:"N/A",address:"N/A",input:{paymentHistory:0,creditUtilization:0,creditHistoryLength:0,creditMix:0,newInquiries:0},financial:{monthlyIncome:0,monthlyExpenses:0,assets:0,dti:0},employer:"N/A",position:"N/A",loans:{approved:{amount:0,status:"None"},pending:{amount:0,status:"None"},loanHistory:[]},loanBalance:{amount:0,dueDate:"N/A"}};function Be(e){var t,n=e.navigation,o=e.route,r=(0,l.useState)(null),a=(0,d.default)(r,2),u=a[0],g=a[1],b=(0,l.useState)(null),m=(0,d.default)(b,2),y=m[0],x=m[1],w=(0,l.useState)(!1),j=(0,d.default)(w,2),v=(j[0],j[1],(0,l.useState)(null)),S=(0,d.default)(v,2),T=(S[0],S[1],J()),P=(T.loans,T.refreshClientData),B=(0,h.default)().width<768,A=function(){var e=(0,i.default)((function*(e){try{try{if(!(yield fetch(C+"/clients")).ok)throw new Error("API server is not responding properly")}catch(n){throw new Error("API server is not running. Please start the credit-scoring-api server first.")}var t=yield D.fetchClientLoanData(e);x(t)}catch(n){console.error("Error fetching loan data:",n)}}));return function(t){return e.apply(this,arguments)}}();if((0,l.useEffect)((function(){var e;if(null!=(e=o.params)&&e.client){var t=Te(Te({},Pe),o.params.client);g(t),t.cid&&(A(t.cid),P(t.cid))}}),[null==(t=o.params)?void 0:t.client]),(0,l.useEffect)((function(){return n.addListener("focus",(function(){null!=u&&u.cid&&(A(u.cid),P(u.cid))}))}),[n,u]),!u)return(0,p.jsx)(s.default,{style:De.container,children:(0,p.jsx)(c.default,{children:"Loading..."})});var M=function(){var e=.35,t=.3,n=.15,o=.1,l=.1,r=u.input,a=e*(r.paymentHistory/100)+t*(1-r.creditUtilization/100)+n*Math.min(r.creditHistoryLength/60,1)+o*(r.creditMix/100)+l*(1-r.newInquiries/100);return Math.round(300+550*a)},O=function(e){return e>=800?"Exceptional":e>=740?"Very Good":e>=670?"Good":e>=580?"Fair":"Poor"};return(0,p.jsxs)(re.default,{style:De.container,showsVerticalScrollIndicator:!1,children:[(0,p.jsxs)(s.default,{style:[De.topbar,B&&De.topbarMobile],children:[(0,p.jsxs)(c.default,{style:[De.logo,B&&De.logoMobile],children:[(0,p.jsx)(c.default,{style:{color:"#0066ff"},children:"Loan"}),"Siya"]}),(0,p.jsx)(c.default,{style:[De.role,B&&De.roleMobile],children:"Loan Officer"})]}),(0,p.jsxs)(s.default,{style:[De.content,B&&De.contentMobile],children:[(0,p.jsxs)(s.default,{style:[De.left,B&&De.leftMobile,B&&{marginBottom:"20%"}],children:[(0,p.jsx)(c.default,{style:[De.sectionTitle,B&&De.sectionTitleMobile],children:"Client Profile"}),(0,p.jsxs)(s.default,{style:De.detailsContainer,children:[(0,p.jsx)(c.default,{style:De.subTitle,children:"Personal Details"}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:De.bold,children:"Name:"})," ",u.name]}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:De.bold,children:"Age:"})," ",u.age]}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:De.bold,children:"CID:"})," ",u.cid]}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:De.bold,children:"Email:"})," ",u.email]}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:De.bold,children:"Number:"})," ",u.number]}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:De.bold,children:"Address:"})," ",u.address]})]}),(0,p.jsx)(c.default,{style:[De.subTitle,{marginTop:B?8:12,marginBottom:B?4:6}],children:"Uploaded Documents"}),(0,p.jsxs)(s.default,{style:De.documentCategory,children:[(0,p.jsx)(c.default,{style:De.categoryText,children:"Application Documents"}),(0,p.jsx)(f.default,{style:De.previewBtn,onPress:(0,i.default)((function*(){try{if(!u.cid)return console.error("No client CID available"),void alert("Error: Client ID not found");var e=yield D.getDocumentDates(u.cid);if(0===e.length)return void alert("No documents found for this client.");var t=e.sort((function(e,t){return t.date.localeCompare(e.date)})),o=[],l=null;for(var r of t){var a=(yield D.getDocumentsByDate(u.cid,r.date)).filter((function(e){var t;return!((null==(t=e.name)?void 0:t.toLowerCase())||"").endsWith(".pdf")}));if(a.length>0){o=a,l=r.date;break}}o.length>0?n.navigate("DocumentPreview",{cid:u.cid,title:"Application Documents",documents:o,latestDate:l}):alert("No application documents found")}catch(i){console.error("Error loading documents:",i),alert("Error loading documents. Please try again.")}})),children:(0,p.jsx)(c.default,{style:De.previewText,children:"View"})})]}),(0,p.jsxs)(s.default,{style:De.documentCategory,children:[(0,p.jsx)(c.default,{style:De.categoryText,children:"Signed Documents"}),(0,p.jsx)(f.default,{style:De.previewBtn,onPress:(0,i.default)((function*(){try{var e=yield D.getDocumentDates(u.cid);if(0===e.length)return void alert("No documents found for this client.");var t=e.sort((function(e,t){return t.date.localeCompare(e.date)})),o=[],l=null;for(var r of t){var a=(yield D.getDocumentsByDate(u.cid,r.date)).filter((function(e){var t;return((null==(t=e.name)?void 0:t.toLowerCase())||"").endsWith(".pdf")}));if(a.length>0){o=a,l=r.date;break}}if(o.length>0){var i=o.map((function(e){return Te(Te({},e),{},{displayName:e.name.includes("promissory-note")?"Promissory Note":"Signed Agreement"})}));n.navigate("DocumentPreview",{cid:u.cid,title:"Signed Documents",documents:i,latestDate:l})}else alert("No signed documents found. Documents will be available after loan approval.")}catch(d){console.error("Error loading documents:",d),alert("Error loading documents. Please try again.")}})),children:(0,p.jsx)(c.default,{style:De.previewText,children:"View"})})]})]}),(0,p.jsxs)(s.default,{style:[De.right,B&&De.rightMobile,B&&{marginTop:"-370px"}],children:[(0,p.jsxs)(s.default,{style:De.detailsContainer,children:[(0,p.jsx)(c.default,{style:De.subTitle,children:"Financial Record"}),(0,p.jsxs)(c.default,{children:["Monthly Income: \u20b1",u.financial.monthlyIncome.toLocaleString()]}),(0,p.jsxs)(c.default,{children:["Monthly Expenses: \u20b1",u.financial.monthlyExpenses.toLocaleString()]}),(0,p.jsxs)(c.default,{children:["Saving and Assets: \u20b1",u.financial.assets.toLocaleString()]}),(0,p.jsxs)(c.default,{children:["Debt to Income Ratio: ",u.financial.dti,"%"]})]}),(0,p.jsxs)(s.default,{style:[De.detailsContainer,{marginTop:16}],children:[(0,p.jsx)(c.default,{style:De.subTitle,children:"Employment or Business info"}),(0,p.jsx)(c.default,{children:u.employer}),(0,p.jsx)(c.default,{children:u.position})]}),(0,p.jsx)(c.default,{style:[De.subTitle,{marginTop:B?8:16,marginBottom:B?4:6}],children:"Loan History"}),(0,p.jsx)(f.default,{style:[De.viewBtn,B&&De.viewBtnMobile],onPress:function(){return n.navigate("LoanHistory",{clientId:u.cid,userRole:"loanofficer",fromPendingDetail:!0})},children:(0,p.jsx)(c.default,{style:{color:"#fff",fontWeight:"600",fontSize:16},children:"View History"})}),(0,p.jsxs)(s.default,{style:[De.loanDetails,B&&De.loanDetailsMobile],children:[(0,p.jsx)(c.default,{style:De.subTitle,children:"Approved by Loan Officer"}),(0,p.jsxs)(c.default,{children:["\u20b1",(null==y?void 0:y.approvedAmount)||"0"]}),(0,p.jsx)(c.default,{style:De.subTitle,children:"Recommended Loan Amount"}),(0,p.jsxs)(c.default,{children:["\u20b1",(null==y?void 0:y.recommendedAmount)||"0"]}),(0,p.jsx)(c.default,{style:De.subTitle,children:"Purpose of Loan"}),(0,p.jsx)(c.default,{children:(null==y?void 0:y.purpose)||"N/A"}),(0,p.jsx)(c.default,{style:De.subTitle,children:"Description of Purpose"}),(0,p.jsx)(c.default,{children:(null==y?void 0:y.description)||"N/A"}),(0,p.jsx)(c.default,{style:De.subTitle,children:"Loan Term (in months)"}),(0,p.jsx)(c.default,{children:(null==y?void 0:y.term)||"N/A"}),(0,p.jsx)(c.default,{style:De.subTitle,children:"Repayment Method"}),(0,p.jsx)(c.default,{children:(null==y?void 0:y.repaymentMethod)||"Monthly"}),(0,p.jsx)(c.default,{style:De.subTitle,children:"Interest Rate"}),(0,p.jsxs)(c.default,{children:[(null==y?void 0:y.interestRate)||"5.0","%"]}),(0,p.jsx)(c.default,{style:De.subTitle,children:"Amount Due"}),(0,p.jsxs)(c.default,{children:["\u20b1",(null==y?void 0:y.amountDue)||"0"]})]}),(0,p.jsxs)(s.default,{style:[De.creditBox,B&&De.creditBoxMobile],children:[(0,p.jsx)(c.default,{style:[De.subTitle,{marginBottom:4}],children:"Credit Score"}),(0,p.jsx)(c.default,{style:De.creditScore,children:(null==y?void 0:y.creditScore)||M()}),(0,p.jsx)(c.default,{style:[De.subTitle,{marginTop:12}],children:"Risk Category"}),(0,p.jsx)(c.default,{style:{color:["Exceptional","Very Good","Good"].includes((null==y?void 0:y.riskCategory)||O(M()))?"#2ecc71":"#e74c3c"},children:(null==y?void 0:y.riskCategory)||O(M())}),(0,p.jsx)(c.default,{style:[De.subTitle,{marginTop:12}],children:"Recommendation"}),(0,p.jsx)(c.default,{style:{color:"APPROVE"===(null==y?void 0:y.recommendation)?"#2ecc71":"#e74c3c"},children:(null==y?void 0:y.recommendation)||(M()>=670?"Approved":"Not Approved")})]}),(0,p.jsx)(f.default,{style:De.backBtn,onPress:function(){return n.goBack()},children:(0,p.jsx)(c.default,{style:De.backText,children:"Back"})})]})]})]})}var De=g.default.create({container:{backgroundColor:"#f6f6f6",flex:1},topbar:{flexDirection:"row",justifyContent:"space-between",backgroundColor:"#ddd",padding:b.default.select({web:20,default:16}),alignItems:"center"},topbarMobile:{padding:12},logo:{fontSize:b.default.select({web:22,default:20}),fontWeight:"bold"},logoMobile:{fontSize:18},role:{fontSize:b.default.select({web:14,default:12})},roleMobile:{fontSize:12},content:{flexDirection:"row",padding:b.default.select({web:20,default:16}),flexWrap:b.default.select({web:"nowrap",default:"wrap"})},contentMobile:{flexDirection:"column",padding:12,gap:0,position:"relative"},left:{flex:b.default.select({web:1.1,default:1}),paddingRight:b.default.select({web:20,default:0}),borderRightWidth:b.default.select({web:1,default:0}),borderColor:"#ccc",minWidth:b.default.select({web:300,default:"100%"}),marginBottom:b.default.select({web:0,default:0})},leftMobile:{width:"100%",paddingRight:0,borderRightWidth:0,marginBottom:"25%",position:"relative",zIndex:1},right:{flex:b.default.select({web:1.3,default:1}),paddingLeft:b.default.select({web:20,default:0}),minWidth:b.default.select({web:300,default:"100%"})},rightMobile:{width:"100%",paddingLeft:0,marginTop:"-40%",position:"relative",zIndex:0},detailsContainer:{backgroundColor:"#fff",padding:b.default.select({web:20,default:16}),borderRadius:8,borderWidth:1,borderColor:"#e0e0e0",marginBottom:16,width:"100%",alignSelf:"stretch"},sectionTitle:{fontWeight:"bold",fontSize:16,marginBottom:10},sectionTitleMobile:{fontSize:16},subTitle:{fontWeight:"bold",marginTop:10,marginBottom:4},bold:{fontWeight:"bold"},documentCategory:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"#f5f5f5",padding:16,marginBottom:10,borderRadius:6,borderWidth:1,borderColor:"#e0e0e0"},categoryText:{fontSize:15,color:"#333",fontWeight:"500"},previewBtn:{backgroundColor:"#0066ff",paddingHorizontal:12,paddingVertical:4,borderRadius:6},previewText:{color:"#fff"},viewBtn:{backgroundColor:"#0066ff",paddingHorizontal:32,paddingVertical:12,borderRadius:8,flexDirection:"row",alignItems:"center",gap:8,minWidth:120,justifyContent:"center"},viewBtnMobile:{width:"100%",paddingVertical:14,minHeight:48},loanDetails:{backgroundColor:"#f8f9fa",padding:b.default.select({web:20,default:16}),borderRadius:8,marginTop:20,borderWidth:1,borderColor:"#e0e0e0"},loanDetailsMobile:{padding:12,marginTop:12},creditBox:{backgroundColor:"#f8f9fa",padding:b.default.select({web:20,default:16}),borderRadius:8,marginTop:20,borderWidth:1,borderColor:"#e0e0e0"},creditBoxMobile:{padding:12,marginTop:12},creditScore:{fontSize:32,fontWeight:"bold",color:"#2ecc71",marginBottom:8},backBtn:{backgroundColor:"#ddd",paddingVertical:b.default.select({web:10,default:12}),paddingHorizontal:b.default.select({web:20,default:16}),borderRadius:6,marginTop:20,alignItems:"center",width:"100%"},backText:{fontSize:16,color:"#333"}});function Ae(e){var t=e.navigation,n=(0,l.useContext)(L),o=n.users,r=(n.loading,n.updateUser),a=(n.refreshUsers,(0,h.default)().width<768),i=function(e){if(e.roleType)switch(e.roleType){case"LOAN_OFFICER":return"Loan Officer";case"OPS_MANAGER":return"Operations Manager";case"IT_ADMIN":return"IT Administrator";default:return e.role||"Unknown"}return e.role||"Unknown"};return(0,p.jsxs)(s.default,{style:Me.container,children:[(0,p.jsxs)(s.default,{style:[Me.topbar,a&&Me.topbarMobile],children:[(0,p.jsxs)(s.default,{style:[Me.leftSection,a&&Me.leftSectionMobile],children:[(0,p.jsxs)(c.default,{style:[Me.brand,a&&Me.brandMobile],children:[(0,p.jsx)(c.default,{style:{color:"#0066ff"},children:"Loan"}),"Siya"]}),!a&&(0,p.jsx)(c.default,{style:Me.title,children:"User Management"})]}),(0,p.jsx)(s.default,{style:Me.rightSection,children:(0,p.jsx)(f.default,{onPress:function(){return t.navigate("Dashboard")},children:(0,p.jsx)(c.default,{style:[Me.backButton,a&&Me.backButtonMobile],children:a?"Back":"Back to Dashboard"})})})]}),(0,p.jsxs)(s.default,{style:[Me.content,a&&Me.contentMobile],children:[(0,p.jsxs)(s.default,{style:[Me.header,a&&Me.headerMobile],children:[(0,p.jsx)(c.default,{style:[Me.pageTitle,a&&Me.pageTitleMobile],children:a?"Users":"Users List"}),(0,p.jsx)(f.default,{style:[Me.addButton,a&&Me.addButtonMobile],onPress:function(){return t.navigate("AddEditUser")},children:(0,p.jsx)(c.default,{style:[Me.addButtonText,a&&Me.addButtonTextMobile],children:a?"Add":"Add User"})})]}),(0,p.jsx)(re.default,{style:Me.table,children:a?(0,p.jsx)(s.default,{style:Me.mobileContainer,children:o.map((function(e){return(0,p.jsxs)(s.default,{style:Me.mobileCard,children:[(0,p.jsxs)(s.default,{style:Me.mobileCardHeader,children:[(0,p.jsx)(c.default,{style:Me.mobileCardName,children:e.fullName}),(0,p.jsx)(c.default,{style:[Me.mobileCardStatus,"Active"===e.status?Me.activeStatus:Me.disabledStatus],children:e.status})]}),(0,p.jsxs)(s.default,{style:Me.mobileCardContent,children:[(0,p.jsxs)(c.default,{style:Me.mobileCardLabel,children:["Username: ",(0,p.jsx)(c.default,{style:Me.mobileCardValue,children:e.username})]}),(0,p.jsxs)(c.default,{style:Me.mobileCardLabel,children:["Role: ",(0,p.jsx)(c.default,{style:Me.mobileCardValue,children:i(e)})]})]}),(0,p.jsxs)(s.default,{style:Me.mobileCardActions,children:[(0,p.jsx)(f.default,{onPress:function(){try{var t="Active"===e.status?"Disabled":"Active";r({id:e.id,status:t})}catch(n){alert("Error updating user: "+n.message)}},style:[Me.mobileActionButton,"Active"===e.status?Me.disableButtonMobile:Me.enableButtonMobile],children:(0,p.jsx)(c.default,{style:Me.mobileActionButtonText,children:"Active"===e.status?"Disable":"Enable"})}),(0,p.jsx)(f.default,{onPress:function(){var n=JSON.parse(JSON.stringify(e));t.navigate("AddEditUser",{user:n})},style:[Me.mobileActionButton,Me.editButtonMobile],children:(0,p.jsx)(c.default,{style:Me.mobileActionButtonText,children:"Edit"})})]})]},e.id)}))}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)(s.default,{style:Me.tableHeader,children:[(0,p.jsx)(c.default,{style:[Me.headerCell,{flex:2}],children:"Name"}),(0,p.jsx)(c.default,{style:[Me.headerCell,{flex:1.5}],children:"Username"}),(0,p.jsx)(c.default,{style:[Me.headerCell,{flex:1}],children:"Role"}),(0,p.jsx)(c.default,{style:[Me.headerCell,{flex:1}],children:"Status"}),(0,p.jsx)(c.default,{style:[Me.headerCell,{flex:1}],children:"Action"})]}),o.map((function(e){return(0,p.jsxs)(s.default,{style:Me.tableRow,children:[(0,p.jsx)(c.default,{style:[Me.cell,{flex:2}],children:e.fullName}),(0,p.jsx)(c.default,{style:[Me.cell,{flex:1.5}],children:e.username}),(0,p.jsx)(c.default,{style:[Me.cell,{flex:1}],children:i(e)}),(0,p.jsx)(c.default,{style:[Me.cell,{flex:1},"Active"===e.status?Me.activeStatus:Me.disabledStatus],children:e.status}),(0,p.jsxs)(s.default,{style:[Me.cell,{flex:1,flexDirection:"row",gap:15}],children:[(0,p.jsx)(f.default,{onPress:function(){try{var t="Active"===e.status?"Disabled":"Active";r({id:e.id,status:t})}catch(n){alert("Error updating user: "+n.message)}},style:Me.actionButtonContainer,children:(0,p.jsx)(c.default,{style:[Me.actionButton,"Active"===e.status?Me.disableButton:Me.enableButton],children:"Active"===e.status?"Disable":"Enable"})}),(0,p.jsx)(f.default,{onPress:function(){var n=JSON.parse(JSON.stringify(e));t.navigate("AddEditUser",{user:n})},style:Me.actionButtonContainer,children:(0,p.jsx)(c.default,{style:Me.editButton,children:"Edit"})})]})]},e.id)}))]})})]})]})}var Me=g.default.create({container:{flex:1,backgroundColor:"#f6f6f6"},topbar:{flexDirection:"row",justifyContent:"space-between",paddingHorizontal:20,paddingVertical:15,backgroundColor:"#ddd",alignItems:"center"},topbarMobile:{paddingHorizontal:15,paddingVertical:12},leftSection:{flexDirection:"row",alignItems:"center",gap:20},leftSectionMobile:{gap:10},rightSection:{flexDirection:"row",alignItems:"center"},brand:{fontSize:22,fontWeight:"bold"},brandMobile:{fontSize:18},title:{fontSize:20,fontWeight:"500"},backButton:{color:"#0066ff",fontSize:16,fontWeight:"500"},backButtonMobile:{fontSize:14},content:{flex:1,padding:20},contentMobile:{padding:15},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},headerMobile:{marginBottom:15},pageTitle:{fontSize:24,fontWeight:"bold"},pageTitleMobile:{fontSize:20},addButton:{backgroundColor:"#0066ff",paddingVertical:8,paddingHorizontal:20,borderRadius:6},addButtonMobile:{paddingVertical:10,paddingHorizontal:15},addButtonText:{color:"#fff",fontWeight:"500"},addButtonTextMobile:{fontSize:14},table:{flex:1},tableHeader:{flexDirection:"row",backgroundColor:"#e2e2e2",padding:12,borderTopLeftRadius:8,borderTopRightRadius:8},headerCell:{fontWeight:"bold",color:"#333"},tableRow:{flexDirection:"row",backgroundColor:"#fff",padding:12,borderBottomWidth:1,borderBottomColor:"#eee"},cell:{color:"#444"},activeStatus:{color:"#28a745"},disabledStatus:{color:"#dc3545"},editButton:{color:"#0066ff",fontWeight:"500"},actionButton:{fontWeight:"500"},enableButton:{color:"#28a745"},disableButton:{color:"#dc3545"},actionButtonContainer:{backgroundColor:"#f5f5f5",paddingVertical:6,paddingHorizontal:12,borderRadius:4},mobileContainer:{gap:15},mobileCard:{backgroundColor:"#fff",borderRadius:8,padding:15,marginBottom:10,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},mobileCardHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:10},mobileCardName:{fontSize:16,fontWeight:"bold",color:"#333",flex:1},mobileCardStatus:{fontSize:14,fontWeight:"500",paddingHorizontal:8,paddingVertical:4,borderRadius:4,backgroundColor:"#f0f0f0"},mobileCardContent:{marginBottom:15},mobileCardLabel:{fontSize:14,color:"#666",marginBottom:5},mobileCardValue:{color:"#333",fontWeight:"500"},mobileCardActions:{flexDirection:"row",gap:10},mobileActionButton:{flex:1,paddingVertical:10,paddingHorizontal:15,borderRadius:6,alignItems:"center"},mobileActionButtonText:{fontSize:14,fontWeight:"500",color:"#fff"},enableButtonMobile:{backgroundColor:"#28a745"},disableButtonMobile:{backgroundColor:"#dc3545"},editButtonMobile:{backgroundColor:"#0066ff"},loadingContainer:{flex:1,justifyContent:"center",alignItems:"center",padding:20},loadingText:{fontSize:16,color:"#666"}}),Oe=n(7366);function Re(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(n),!0).forEach((function(t){(0,x.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Re(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ke(e){var t=e.route,n=e.navigation,o=(t.params||{}).user,r=o?JSON.parse(JSON.stringify(o)):void 0,a=(0,l.useContext)(L),g=a.addUser,b=a.updateUser,m=(0,h.default)().width<768,y=function(e){switch(e){case"Loan Officer":default:return"LOAN_OFFICER";case"Operations Manager":return"OPS_MANAGER";case"IT Administrator":return"IT_ADMIN"}},x=(0,l.useState)({username:(null==r?void 0:r.username)||"",fullName:(null==r?void 0:r.fullName)||"",role:r?function(e){switch(e){case"LOAN_OFFICER":default:return"Loan Officer";case"OPS_MANAGER":return"Operations Manager";case"IT_ADMIN":return"IT Administrator"}}(r.roleType||r.role):"Loan Officer",status:(null==r?void 0:r.status)||"Active",password:"",confirmPassword:"",newPassword:"",confirmNewPassword:""}),w=(0,d.default)(x,2),j=w[0],v=w[1],C=function(){var e=(0,i.default)((function*(){var e=Le(Le({},j),{},{username:j.username.trim(),fullName:j.fullName.trim()});if(e.username&&e.fullName)if(e.username.length<3)alert("Username must be at least 3 characters long");else if(e.fullName.length<2)alert("Full name must be at least 2 characters long");else if(r||e.password&&e.confirmPassword)if(r||e.password===e.confirmPassword)if(!r&&e.password.length<6)alert("Password must be at least 6 characters long");else{if(r&&e.newPassword){if(!e.confirmNewPassword)return void alert("Please confirm the new password");if(e.newPassword!==e.confirmNewPassword)return void alert("New passwords do not match");if(e.newPassword.length<6)return void alert("New password must be at least 6 characters long")}var t={username:e.username,fullName:e.fullName,role:y(e.role),status:e.status,password:r?e.newPassword||void 0:e.password};try{r?(yield b(Le(Le({},t),{},{id:r.id})),alert("User updated successfully!")):(yield g(t),alert("User added successfully!")),n.setParams({user:void 0}),n.goBack()}catch(o){return void alert("Error: "+o.message)}}else alert("Passwords do not match");else alert("Password is required for new users");else alert("Please fill in all required fields (Username and Full Name)")}));return function(){return e.apply(this,arguments)}}();return(0,p.jsxs)(s.default,{style:Ie.container,children:[(0,p.jsxs)(s.default,{style:[Ie.topbar,m&&Ie.topbarMobile],children:[(0,p.jsxs)(s.default,{style:[Ie.leftSection,m&&Ie.leftSectionMobile],children:[(0,p.jsxs)(c.default,{style:[Ie.brand,m&&Ie.brandMobile],children:[(0,p.jsx)(c.default,{style:{color:"#0066ff"},children:"Loan"}),"Siya"]}),!m&&(0,p.jsx)(c.default,{style:Ie.title,children:r?"Edit User":"Add User"})]}),(0,p.jsx)(s.default,{style:Ie.rightSection,children:(0,p.jsx)(f.default,{onPress:function(){return n.goBack()},children:(0,p.jsx)(c.default,{style:[Ie.backButton,m&&Ie.backButtonMobile],children:m?"Back":"Back to List"})})})]}),(0,p.jsxs)(re.default,{style:[Ie.content,m&&Ie.contentMobile],showsVerticalScrollIndicator:!1,children:[m&&(0,p.jsx)(c.default,{style:Ie.mobileTitle,children:r?"Edit User":"Add User"}),(0,p.jsxs)(s.default,{style:[Ie.form,m&&Ie.formMobile],children:[(0,p.jsx)(c.default,{style:[Ie.label,m&&Ie.labelMobile],children:"Full Name"}),(0,p.jsx)(u.default,{style:[Ie.input,m&&Ie.inputMobile],value:j.fullName,onChangeText:function(e){return v(Le(Le({},j),{},{fullName:e}))},placeholder:"Enter full name"}),(0,p.jsx)(c.default,{style:[Ie.label,m&&Ie.labelMobile],children:"Username"}),(0,p.jsx)(u.default,{style:[Ie.input,m&&Ie.inputMobile],value:j.username,onChangeText:function(e){return v(Le(Le({},j),{},{username:e}))},placeholder:"Enter username",editable:!r}),(0,p.jsx)(c.default,{style:[Ie.label,m&&Ie.labelMobile],children:"Role"}),(0,p.jsx)(s.default,{style:[Ie.pickerContainer,m&&Ie.pickerContainerMobile],children:(0,p.jsxs)(Oe.Picker,{selectedValue:j.role,onValueChange:function(e){return v(Le(Le({},j),{},{role:e}))},children:[(0,p.jsx)(Oe.Picker.Item,{label:"Loan Officer",value:"Loan Officer"}),(0,p.jsx)(Oe.Picker.Item,{label:"Operations Manager",value:"Operations Manager"}),r&&"IT_ADMIN"===r.roleType&&(0,p.jsx)(Oe.Picker.Item,{label:"IT Administrator",value:"IT Administrator"})]})}),r&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(c.default,{style:[Ie.label,m&&Ie.labelMobile],children:"Status"}),(0,p.jsx)(s.default,{style:[Ie.pickerContainer,m&&Ie.pickerContainerMobile],children:(0,p.jsxs)(Oe.Picker,{selectedValue:j.status,onValueChange:function(e){return v(Le(Le({},j),{},{status:e}))},children:[(0,p.jsx)(Oe.Picker.Item,{label:"Active",value:"Active"}),(0,p.jsx)(Oe.Picker.Item,{label:"Disabled",value:"Disabled"})]})}),(0,p.jsxs)(s.default,{style:[Ie.passwordSection,m&&Ie.passwordSectionMobile],children:[(0,p.jsx)(c.default,{style:[Ie.sectionTitle,m&&Ie.sectionTitleMobile],children:"Change Password"}),(0,p.jsx)(c.default,{style:[Ie.label,m&&Ie.labelMobile],children:"New Password"}),(0,p.jsx)(u.default,{style:[Ie.input,m&&Ie.inputMobile],secureTextEntry:!0,value:j.newPassword,onChangeText:function(e){return v(Le(Le({},j),{},{newPassword:e}))},placeholder:"Enter new password (optional)"}),(0,p.jsx)(c.default,{style:[Ie.label,m&&Ie.labelMobile],children:"Confirm New Password"}),(0,p.jsx)(u.default,{style:[Ie.input,m&&Ie.inputMobile],secureTextEntry:!0,value:j.confirmNewPassword,onChangeText:function(e){return v(Le(Le({},j),{},{confirmNewPassword:e}))},placeholder:"Confirm new password"})]})]}),!r&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(c.default,{style:[Ie.label,m&&Ie.labelMobile],children:"Password"}),(0,p.jsx)(u.default,{style:[Ie.input,m&&Ie.inputMobile],secureTextEntry:!0,value:j.password,onChangeText:function(e){return v(Le(Le({},j),{},{password:e}))},placeholder:"Enter password"}),(0,p.jsx)(c.default,{style:[Ie.label,m&&Ie.labelMobile],children:"Confirm Password"}),(0,p.jsx)(u.default,{style:[Ie.input,m&&Ie.inputMobile],secureTextEntry:!0,value:j.confirmPassword,onChangeText:function(e){return v(Le(Le({},j),{},{confirmPassword:e}))},placeholder:"Confirm password"})]}),(0,p.jsx)(f.default,{style:[Ie.saveButton,m&&Ie.saveButtonMobile],onPress:C,children:(0,p.jsx)(c.default,{style:[Ie.saveButtonText,m&&Ie.saveButtonTextMobile],children:"Save User"})})]})]})]})}var Ie=g.default.create({container:{flex:1,backgroundColor:"#f6f6f6"},topbar:{flexDirection:"row",justifyContent:"space-between",paddingHorizontal:20,paddingVertical:15,backgroundColor:"#ddd",alignItems:"center"},topbarMobile:{paddingHorizontal:15,paddingVertical:12},leftSection:{flexDirection:"row",alignItems:"center",gap:20},leftSectionMobile:{gap:10},rightSection:{flexDirection:"row",alignItems:"center"},brand:{fontSize:22,fontWeight:"bold"},brandMobile:{fontSize:18},title:{fontSize:20,fontWeight:"500"},backButton:{color:"#0066ff",fontSize:16,fontWeight:"500"},backButtonMobile:{fontSize:14},content:{flex:1,padding:20,overflow:"auto"},contentMobile:{padding:15},mobileTitle:{fontSize:22,fontWeight:"bold",color:"#333",textAlign:"center",marginBottom:20},form:{backgroundColor:"#fff",padding:20,borderRadius:8,maxWidth:500,width:"100%",alignSelf:"center",overflow:"visible",minHeight:"min-content"},formMobile:{padding:15,maxWidth:"100%",borderRadius:12},label:{fontSize:16,marginBottom:8,color:"#333"},labelMobile:{fontSize:15,marginBottom:6},input:{backgroundColor:"#f5f5f5",padding:12,borderRadius:6,marginBottom:16,fontSize:16},inputMobile:{padding:14,fontSize:16,marginBottom:18},pickerContainer:{backgroundColor:"#f5f5f5",borderRadius:6,marginBottom:16,overflow:"hidden"},pickerContainerMobile:{marginBottom:18},saveButton:{backgroundColor:"#0066ff",padding:15,borderRadius:6,alignItems:"center",marginTop:10},saveButtonMobile:{padding:16,borderRadius:8,marginTop:20},saveButtonText:{color:"#fff",fontSize:16,fontWeight:"600"},saveButtonTextMobile:{fontSize:17},passwordSection:{marginTop:16,marginBottom:16,padding:12,backgroundColor:"#f8f9fa",borderRadius:6,borderWidth:1,borderColor:"#e9ecef"},passwordSectionMobile:{padding:15,marginTop:20,marginBottom:20},sectionTitle:{fontSize:18,fontWeight:"600",marginBottom:16,color:"#333"},sectionTitleMobile:{fontSize:17,marginBottom:12}});function ze(e){var t=e.navigation;return(0,p.jsx)(ne,{navigation:t,userRole:"ops",dashboardRoute:"OpsDashboard"})}function Ee(e){var t=e.navigation,n=e.route;return(0,p.jsx)(me,{navigation:t,route:n,userRole:"ops"})}function We(e){var t=e.navigation,n=J().loans,o=(0,l.useState)(""),r=(0,d.default)(o,2),a=r[0],i=r[1],g=(0,h.default)().width<768,b=n.filter((function(e){return e.name.toLowerCase().includes(a.toLowerCase())||e.cid.includes(a)})),m=function(e){var t;return null!=(t=e.loans)&&t.loanHistory&&e.loans.loanHistory.length>0?(0,V.default)(e.loans.loanHistory).sort((function(e,t){return new Date(t.dateApplied)-new Date(e.dateApplied)}))[0].dateApplied:"No date"};return(0,p.jsxs)(s.default,{style:Ne.container,children:[(0,p.jsxs)(s.default,{style:[Ne.headerRow,g&&Ne.headerRowMobile],children:[(0,p.jsx)(c.default,{style:[Ne.title,g&&Ne.titleMobile],children:"List of Pending Loan Approval"}),(0,p.jsx)(f.default,{style:[Ne.dashboardBtn,g&&Ne.dashboardBtnMobile],onPress:function(){return t.replace("OpsDashboard")},children:(0,p.jsx)(c.default,{style:[Ne.btnText,g&&Ne.btnTextMobile],children:"Go to Dashboard"})})]}),(0,p.jsx)(s.default,{style:[Ne.searchBar,g&&Ne.searchBarMobile],children:(0,p.jsx)(u.default,{style:[Ne.searchInput,g&&Ne.searchInputMobile],placeholder:"Search by name or CID",value:a,onChangeText:i})}),!g&&(0,p.jsxs)(s.default,{style:Ne.tableHeader,children:[(0,p.jsx)(c.default,{style:[Ne.headerCell,{flex:1,textAlign:"center"}],children:"CID"}),(0,p.jsx)(c.default,{style:[Ne.headerCell,{flex:3,textAlign:"center"}],children:"Full Name"}),(0,p.jsx)(c.default,{style:[Ne.headerCell,{flex:2,textAlign:"center"}],children:"Loan Status"}),(0,p.jsx)(c.default,{style:[Ne.headerCell,{flex:3,textAlign:"center"}],children:"Date Applied"}),(0,p.jsx)(c.default,{style:[Ne.headerCell,{flex:1}]})]}),(0,p.jsx)(Q.default,{data:b,keyExtractor:function(e){return e.cid},renderItem:function(e){var n=e.item;return(0,p.jsx)(f.default,{style:[Ne.row,g&&Ne.rowMobile],onPress:function(){return g&&t.navigate("OpsPendingLoanDetail",{client:n,backScreen:"OpsPendingList"})},children:g?(0,p.jsxs)(s.default,{style:Ne.mobileContent,children:[(0,p.jsx)(c.default,{style:Ne.mobileName,children:n.name}),(0,p.jsxs)(c.default,{style:Ne.mobileCid,children:["CID: ",n.cid]}),(0,p.jsxs)(s.default,{style:Ne.mobileStatusRow,children:[(0,p.jsx)(c.default,{style:[Ne.mobileStatus,n.status&&"approved"===n.status.toLowerCase()&&Ne.approvedStatus,n.status&&"declined"===n.status.toLowerCase()&&Ne.declinedStatus,(!n.status||"pending"===n.status.toLowerCase())&&Ne.pendingStatus],children:n.status?n.status.charAt(0).toUpperCase()+n.status.slice(1).toLowerCase():"Pending"}),(0,p.jsx)(c.default,{style:Ne.mobileDate,children:m(n)})]})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(c.default,{style:[Ne.cell,{flex:1,textAlign:"center"}],children:n.cid}),(0,p.jsx)(c.default,{style:[Ne.cell,{flex:3,textAlign:"center"}],children:n.name}),(0,p.jsx)(c.default,{style:[Ne.cell,{flex:2,textAlign:"center"},n.status&&"approved"===n.status.toLowerCase()&&Ne.approvedStatus,n.status&&"declined"===n.status.toLowerCase()&&Ne.declinedStatus,(!n.status||"pending"===n.status.toLowerCase())&&Ne.pendingStatus],children:n.status?n.status.charAt(0).toUpperCase()+n.status.slice(1).toLowerCase():"Pending"}),(0,p.jsx)(c.default,{style:[Ne.cell,{flex:3,textAlign:"center"}],children:m(n)}),(0,p.jsx)(s.default,{style:{flex:1,alignItems:"center"},children:(0,p.jsx)(f.default,{style:Ne.viewBtn,onPress:function(){t.navigate("OpsPendingLoanDetail",{client:n,backScreen:"OpsPendingList"})},children:(0,p.jsx)(c.default,{style:Ne.viewBtnText,children:"View"})})})]})})},contentContainerStyle:Ne.listContainer})]})}var Ne=g.default.create({container:{padding:b.default.select({web:20,default:16}),backgroundColor:"#f6f6f6",flex:1},headerRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:b.default.select({web:20,default:16})},headerRowMobile:{marginBottom:12},title:{fontSize:b.default.select({web:22,default:20}),fontWeight:"bold"},titleMobile:{fontSize:18},dashboardBtn:{backgroundColor:"#007bff",paddingVertical:b.default.select({web:10,default:8}),paddingHorizontal:b.default.select({web:16,default:12}),borderRadius:8},dashboardBtnMobile:{paddingVertical:8,paddingHorizontal:10},btnText:{color:"#fff",fontWeight:"600",fontSize:b.default.select({web:16,default:14})},btnTextMobile:{fontSize:12},searchBar:{flexDirection:"row",marginBottom:b.default.select({web:16,default:12})},searchBarMobile:{marginBottom:10},searchInput:{backgroundColor:"#fff",borderRadius:8,padding:b.default.select({web:12,default:10}),flex:1,fontSize:b.default.select({web:16,default:14}),borderWidth:1,borderColor:"#ddd"},searchInputMobile:{padding:8,fontSize:14},tableHeader:{flexDirection:"row",backgroundColor:"#e9ecef",paddingVertical:12,paddingHorizontal:8,marginBottom:4,borderRadius:8},headerCell:{fontWeight:"bold",fontSize:16,color:"#495057"},row:{flexDirection:"row",backgroundColor:"#fff",paddingVertical:b.default.select({web:12,default:10}),paddingHorizontal:b.default.select({web:8,default:6}),marginBottom:8,borderRadius:8,alignItems:"center",borderWidth:1,borderColor:"#e9ecef"},rowMobile:{padding:12},cell:{fontSize:b.default.select({web:16,default:14}),paddingHorizontal:6,color:"#212529"},mobileContent:{flex:1},mobileName:{fontSize:16,fontWeight:"500",marginBottom:4,color:"#212529"},mobileCid:{fontSize:14,color:"#6c757d",marginBottom:6},mobileStatusRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},mobileStatus:{fontSize:14,fontWeight:"500"},mobileDate:{fontSize:12,color:"#6c757d"},approvedStatus:{color:"#2ecc71",fontWeight:"bold"},pendingStatus:{color:"#000000",fontWeight:"bold"},declinedStatus:{color:"#e74c3c",fontWeight:"bold"},viewBtn:{backgroundColor:"#e9ecef",paddingVertical:8,paddingHorizontal:16,borderRadius:6},viewBtnText:{color:"#495057",fontSize:14,fontWeight:"500"},listContainer:{flexGrow:1}}),He=n(45),Ve=["documents"];function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){(0,x.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Fe={name:"N/A",age:0,cid:"",email:"N/A",number:"N/A",address:"N/A",input:{paymentHistory:0,creditUtilization:0,creditHistoryLength:0,creditMix:0,newInquiries:0},financial:{monthlyIncome:0,monthlyExpenses:0,assets:0,dti:0},employer:"N/A",position:"N/A",loans:{approved:{amount:0,status:"None"},pending:{amount:0,status:"None"},loanHistory:[]},loanBalance:{amount:0,dueDate:"N/A"},documents:{applicationDocs:B.APPLICATION_DOCS,signedDocuments:[]}};function Ge(e){var t,n,o,r,a=e.navigation,g=e.route,b=J(),y=b.updateLoan,x=b.updateLoanAmount,w=(0,l.useContext)(m).currentUser,j=(0,h.default)().width<768,v=(0,l.useState)(null),S=(0,d.default)(v,2),T=S[0],P=S[1],B=(0,l.useState)(null),A=(0,d.default)(B,2),M=A[0],O=A[1],R=(0,l.useState)(!1),L=(0,d.default)(R,2),k=L[0],I=L[1],z=(0,l.useState)(""),E=(0,d.default)(z,2),W=E[0],N=E[1],H=(0,l.useState)(""),_=(0,d.default)(H,2),U=_[0],F=_[1],G=(0,l.useState)(""),q=(0,d.default)(G,2),K=q[0],X=q[1],Y=(0,l.useState)(null),Q=(0,d.default)(Y,2),Z=(Q[0],Q[1]),$=function(){var e=(0,i.default)((function*(e){try{var t=yield fetch(C+"/client-loan-data/"+e);if(!t.ok)throw new Error("Failed to fetch loan data");var n=yield t.json();O(n)}catch(o){console.error("Error fetching loan data:",o),F("Failed to fetch loan data")}}));return function(t){return e.apply(this,arguments)}}();if((0,l.useEffect)((function(){var e,t;if((null==T||null==(e=T.loans)||null==(t=e.loanHistory)?void 0:t.length)>0){var n=(0,V.default)(T.loans.loanHistory).sort((function(e,t){return new Date(t.dateApplied)-new Date(e.dateApplied)}))[0];Z(n)}}),[T]),(0,l.useEffect)((function(){var e;if(console.log("Route params:",g.params),null!=(e=g.params)&&e.client){var t,n;console.log("Initializing client with:",g.params.client);var o=Ue(Ue(Ue({},Fe),g.params.client),{},{documents:{applicationDocs:(null==(t=g.params.client.documents)?void 0:t.applicationDocs)||Fe.documents.applicationDocs,signedDocuments:(null==(n=g.params.client.documents)?void 0:n.signedDocuments)||[]}});console.log("Setting client with CID:",o.cid),P(o),o.cid&&$(o.cid)}}),[null==(t=g.params)?void 0:t.client]),!T)return(0,p.jsx)(s.default,{style:qe.container,children:(0,p.jsx)(c.default,{children:"Loading..."})});var ee=function(){var e=(0,i.default)((function*(){try{F(""),console.log("Declining loan for CID:",T.cid);try{if(!(yield fetch(C+"/clients")).ok)throw new Error("API server is not responding properly")}catch(t){throw new Error("API server is not running. Please start the credit-scoring-api server first.")}var e=yield D.processLoanDecision(T.cid,"declined");console.log("API Response:",e),yield y(T.cid,{status:"Declined",decidedAt:(new Date).toISOString()}),console.log("Local state updated"),X("Loan application declined"),setTimeout((function(){a.replace("OpsPendingList")}),1e3)}catch(t){console.error("Error declining loan:",t),F(t.message||"Failed to decline loan"),setTimeout((function(){return F("")}),3e3)}}));return function(){return e.apply(this,arguments)}}(),te=(function(){var e=(0,i.default)((function*(){try{F(""),console.log("Approving loan for CID:",T.cid);try{if(!(yield fetch(C+"/clients")).ok)throw new Error("API server is not responding properly")}catch(o){throw new Error("API server is not running. Please start the credit-scoring-api server first.")}var e=(null==M?void 0:M.approvedAmount)||"0",t=(T.documents,(0,He.default)(T,Ve)),n=yield D.processLoanDecision(T.cid,"approved",Ue({approvedAmount:null==M?void 0:M.approvedAmount},t));console.log("API Response:",n),yield y(T.cid,{status:"Approved",decidedAt:(new Date).toISOString(),approvedAmount:e}),console.log("Local state updated"),X("Loan application approved"),setTimeout((function(){a.replace("OpsPendingList")}),1e3)}catch(o){console.error("Error approving loan:",o),F(o.message||"Failed to approve loan"),setTimeout((function(){return F("")}),3e3)}}))}(),function(){var e=(0,i.default)((function*(){try{var e,t=parseInt(W);if(!t||t<=0)return void F("Please enter a valid amount");var n=(null==M?void 0:M.approvedAmount)||0;if(t>n)return void F("Amount cannot exceed approved amount of \u20b1"+n.toLocaleString());if(null!=(e=T.loans)&&e.loanHistory&&T.loans.loanHistory.length>0){var o=(0,V.default)(T.loans.loanHistory).sort((function(e,t){return new Date(t.dateApplied)-new Date(e.dateApplied)}))[0],l=t+.05*t,r=Ue(Ue({},o),{},{amount:t,amountDue:{total:l}}),a=Ue(Ue({},T),{},{loans:Ue(Ue({},T.loans),{},{loanHistory:T.loans.loanHistory.map((function(e){return e.dateApplied===o.dateApplied?r:e}))})});yield x(T.cid,t),Z(r),P(a),yield $(T.cid),I(!1),X("Loan amount updated successfully")}}catch(U){F("Failed to update loan amount"),console.error("Error updating loan amount:",U)}}));return function(){return e.apply(this,arguments)}}()),ne=function(){var e=.35,t=.3,n=.15,o=.1,l=.1,r=T.input,a=e*(r.paymentHistory/100)+t*(1-r.creditUtilization/100)+n*Math.min(r.creditHistoryLength/60,1)+o*(r.creditMix/100)+l*(1-r.newInquiries/100);return Math.round(300+550*a)},oe=function(e){return e>=800?"Exceptional":e>=740?"Very Good":e>=670?"Good":e>=580?"Fair":"Poor"};return(0,p.jsxs)(re.default,{style:qe.container,showsVerticalScrollIndicator:!1,children:[(0,p.jsxs)(s.default,{style:[qe.topbar,j&&qe.topbarMobile],children:[(0,p.jsxs)(c.default,{style:[qe.logo,j&&qe.logoMobile],children:[(0,p.jsx)(c.default,{style:{color:"#0066ff"},children:"Loan"}),"Siya"]}),(0,p.jsx)(c.default,{style:[qe.role,j&&qe.roleMobile],children:"ops"===(null==w?void 0:w.role)?"Operations Manager":(null==w?void 0:w.username)||"Operations Manager"})]}),(0,p.jsxs)(s.default,{style:[qe.content,j&&qe.contentMobile],children:[(0,p.jsxs)(s.default,{style:[qe.left,j&&qe.leftMobile,j&&{marginBottom:"25%"}],children:[(0,p.jsx)(c.default,{style:[qe.sectionTitle,j&&qe.sectionTitleMobile],children:"Client Profile"}),(0,p.jsxs)(s.default,{style:qe.detailsContainer,children:[(0,p.jsx)(c.default,{style:qe.subTitle,children:"Personal Details"}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:qe.bold,children:"Name:"})," ",T.name]}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:qe.bold,children:"Age:"})," ",T.age]}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:qe.bold,children:"CID:"})," ",T.cid]}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:qe.bold,children:"Email:"})," ",T.email]}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:qe.bold,children:"Number:"})," ",T.number]}),(0,p.jsxs)(c.default,{children:[(0,p.jsx)(c.default,{style:qe.bold,children:"Address:"})," ",T.address]})]}),(0,p.jsx)(c.default,{style:[qe.subTitle,{marginTop:j?8:12,marginBottom:j?4:6}],children:"Uploaded Documents"}),(0,p.jsxs)(s.default,{style:qe.documentCategory,children:[(0,p.jsx)(c.default,{style:qe.categoryText,children:"Application Documents"}),(0,p.jsx)(f.default,{style:qe.previewBtn,onPress:(0,i.default)((function*(){try{if(!T.cid)return console.error("No client CID available"),void alert("Error: Client ID not found");var e=yield D.getDocumentDates(T.cid);if(0===e.length)return void alert("No documents found for this client.");var t=e.sort((function(e,t){return t.date.localeCompare(e.date)})),n=[],o=null;for(var l of t){var r=(yield D.getDocumentsByDate(T.cid,l.date)).filter((function(e){var t;return!((null==(t=e.name)?void 0:t.toLowerCase())||"").endsWith(".pdf")}));if(r.length>0){n=r,o=l.date;break}}n.length>0?a.navigate("DocumentPreview",{cid:T.cid,title:"Application Documents",documents:n,latestDate:o}):alert("No application documents found")}catch(U){console.error("Error loading documents:",U),alert("Error loading documents. Please try again.")}})),children:(0,p.jsx)(c.default,{style:qe.previewText,children:"View"})})]}),(0,p.jsxs)(s.default,{style:[qe.documentCategory,{marginBottom:j?4:10}],children:[(0,p.jsx)(c.default,{style:qe.categoryText,children:"Signed Documents"}),(0,p.jsx)(f.default,{style:qe.previewBtn,onPress:(0,i.default)((function*(){try{var e=yield D.getDocumentDates(T.cid);if(0===e.length)return void alert("No documents found for this client.");var t=e.sort((function(e,t){return t.date.localeCompare(e.date)})),n=[],o=null;for(var l of t){var r=(yield D.getDocumentsByDate(T.cid,l.date)).filter((function(e){var t;return((null==(t=e.name)?void 0:t.toLowerCase())||"").endsWith(".pdf")}));if(r.length>0){n=r,o=l.date;break}}if(n.length>0){var i=n.map((function(e){return Ue(Ue({},e),{},{displayName:e.name.includes("promissory-note")?"Promissory Note":"Signed Agreement"})}));a.navigate("DocumentPreview",{cid:T.cid,title:"Signed Documents",documents:i,latestDate:o})}else alert("No signed documents found. Documents will be available after loan approval.")}catch(U){console.error("Error loading documents:",U),alert("Error loading documents. Please try again.")}})),children:(0,p.jsx)(c.default,{style:qe.previewText,children:"View"})})]})]}),(0,p.jsxs)(s.default,{style:[qe.right,j&&qe.rightMobile,j&&{marginTop:"-450px"}],children:[(0,p.jsxs)(s.default,{style:qe.detailsContainer,children:[(0,p.jsx)(c.default,{style:qe.subTitle,children:"Financial Record"}),(0,p.jsxs)(c.default,{children:["Monthly Income: \u20b1",T.financial.monthlyIncome.toLocaleString()]}),(0,p.jsxs)(c.default,{children:["Monthly Expenses: \u20b1",T.financial.monthlyExpenses.toLocaleString()]}),(0,p.jsxs)(c.default,{children:["Saving and Assets: \u20b1",T.financial.assets.toLocaleString()]}),(0,p.jsxs)(c.default,{children:["Debt to Income Ratio: ",T.financial.dti,"%"]})]}),(0,p.jsxs)(s.default,{style:[qe.detailsContainer,{marginTop:16}],children:[(0,p.jsx)(c.default,{style:qe.subTitle,children:"Employment or Business info"}),(0,p.jsx)(c.default,{children:T.employer}),(0,p.jsx)(c.default,{children:T.position})]}),(0,p.jsx)(c.default,{style:[qe.subTitle,{marginTop:j?8:16}],children:"Loan History"}),(0,p.jsx)(f.default,{style:qe.viewBtn,onPress:function(){return a.navigate("LoanHistory",{clientId:T.cid,userRole:"ops",fromPendingDetail:!0})},children:(0,p.jsx)(c.default,{style:{color:"#fff",fontWeight:"600",fontSize:16},children:"View History"})}),(0,p.jsxs)(s.default,{style:[qe.loanDetails,j&&{marginTop:8}],children:[(0,p.jsx)(c.default,{style:qe.subTitle,children:"Approved by Loan Officer"}),(0,p.jsxs)(c.default,{children:["\u20b1",(null==M||null==(n=M.approvedAmount)?void 0:n.toLocaleString())||"0"]}),(0,p.jsx)(c.default,{style:qe.subTitle,children:"Recommended Loan Amount (Based on Credit Score)"}),(0,p.jsxs)(c.default,{children:["\u20b1",(null==M||null==(o=M.recommendedAmount)?void 0:o.toLocaleString())||"0"]}),(0,p.jsx)(c.default,{style:qe.subTitle,children:"Purpose of Loan"}),(0,p.jsx)(c.default,{children:(null==M?void 0:M.purpose)||"N/A"}),(0,p.jsx)(c.default,{style:qe.subTitle,children:"Description of Purpose"}),(0,p.jsx)(c.default,{children:(null==M?void 0:M.description)||"N/A"}),(0,p.jsx)(c.default,{style:qe.subTitle,children:"Loan Term (in months)"}),(0,p.jsx)(c.default,{children:(null==M?void 0:M.term)||"N/A"}),(0,p.jsx)(c.default,{style:qe.subTitle,children:"Repayment Method"}),(0,p.jsx)(c.default,{children:(null==M?void 0:M.repaymentMethod)||"Monthly"}),(0,p.jsx)(c.default,{style:qe.subTitle,children:"Interest Rate"}),(0,p.jsxs)(c.default,{children:[(null==M?void 0:M.interestRate)||"5.0","%"]}),(0,p.jsx)(c.default,{style:qe.subTitle,children:"Amount Due"}),(0,p.jsxs)(c.default,{children:["\u20b1",(null==M?void 0:M.amountDue)||"0"]})]}),(0,p.jsxs)(s.default,{style:qe.creditBox,children:[(0,p.jsx)(c.default,{style:[qe.subTitle,{marginBottom:4}],children:"Credit Score"}),(0,p.jsx)(c.default,{style:qe.creditScore,children:(null==M?void 0:M.creditScore)||ne()}),(0,p.jsx)(c.default,{style:[qe.subTitle,{marginTop:12}],children:"Risk Category"}),(0,p.jsx)(c.default,{style:{color:["Exceptional","Very Good","Good"].includes((null==M?void 0:M.riskCategory)||oe(ne()))?"#2ecc71":"#e74c3c"},children:(null==M?void 0:M.riskCategory)||oe(ne())}),(0,p.jsx)(c.default,{style:[qe.subTitle,{marginTop:12}],children:"Recommendation"}),(0,p.jsx)(c.default,{style:{color:"APPROVE"===(null==M?void 0:M.recommendation)?"#2ecc71":"#e74c3c"},children:(null==M?void 0:M.recommendation)||(ne()>=670?"Approved":"Not Approved")})]}),(0,p.jsxs)(s.default,{style:[qe.actionRow,j&&qe.actionRowMobile],children:[(0,p.jsx)(f.default,{style:[qe.backBtn,j&&qe.btnMobile],onPress:function(){return a.goBack()},children:(0,p.jsx)(c.default,{children:"\u2190 Back"})}),(0,p.jsx)(f.default,{style:[qe.editBtn,j&&qe.btnMobile],onPress:function(){var e,t=(null==M||null==(e=M.approvedAmount)?void 0:e.toString())||"0";N(t),I(!0)},children:(0,p.jsx)(c.default,{children:"Edit"})}),(0,p.jsx)(f.default,{style:[qe.declineBtn,j&&qe.btnMobile],onPress:ee,children:(0,p.jsx)(c.default,{style:{color:"#fff"},children:"Decline"})}),(0,p.jsx)(f.default,{style:[qe.approveBtn,j&&qe.btnMobile],onPress:function(){return a.navigate("SignatureAgreement",{client:T,loanData:M})},children:(0,p.jsx)(c.default,{style:{color:"#fff"},children:"Sign Agreement"})})]})]})]}),(0,p.jsx)(ae.default,{visible:k,transparent:!0,animationType:"fade",children:(0,p.jsx)(s.default,{style:qe.modalOverlay,children:(0,p.jsxs)(s.default,{style:[qe.modalContent,j&&qe.modalContentMobile],children:[(0,p.jsx)(c.default,{style:[qe.modalTitle,j&&qe.modalTitleMobile],children:"Edit Loan Amount"}),(0,p.jsxs)(c.default,{style:[qe.modalSubtitle,j&&qe.modalSubtitleMobile],children:["Maximum amount: \u20b1",(null==M||null==(r=M.approvedAmount)?void 0:r.toLocaleString())||"0"]}),(0,p.jsx)(u.default,{style:[qe.amountInput,j&&qe.amountInputMobile],value:W,onChangeText:function(e){N(e.replace(/[^0-9]/g,"")),F("")},keyboardType:"numeric",placeholder:"Enter amount",placeholderTextColor:"#999"}),U?(0,p.jsx)(c.default,{style:[qe.errorText,j&&qe.errorTextMobile],children:U}):null,(0,p.jsxs)(s.default,{style:[qe.modalButtons,j&&qe.modalButtonsMobile],children:[(0,p.jsx)(f.default,{style:[qe.cancelBtn,j&&qe.cancelBtnMobile],onPress:function(){I(!1),F("")},children:(0,p.jsx)(c.default,{style:[qe.modalButtonText,j&&qe.modalButtonTextMobile],children:"Cancel"})}),(0,p.jsx)(f.default,{style:[qe.saveBtn,j&&qe.saveBtnMobile],onPress:te,children:(0,p.jsx)(c.default,{style:[qe.modalButtonTextWhite,j&&qe.modalButtonTextWhiteMobile],children:"Save Changes"})})]})]})})}),K?(0,p.jsx)(s.default,{style:qe.successMessage,children:(0,p.jsx)(c.default,{style:qe.successText,children:K})}):null,U?(0,p.jsx)(s.default,{style:qe.errorMessage,children:(0,p.jsx)(c.default,{style:qe.errorText,children:U})}):null]})}var Je,qe=g.default.create({documentCategory:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",backgroundColor:"#f5f5f5",padding:16,marginBottom:10,borderRadius:6,borderWidth:1,borderColor:"#e0e0e0"},categoryText:{fontSize:15,color:"#333",fontWeight:"500"},previewBtn:{backgroundColor:"#0066ff",paddingHorizontal:12,paddingVertical:4,borderRadius:6},previewText:{color:"#fff"},modalOverlay:{flex:1,backgroundColor:"rgba(0,0,0,0.5)",justifyContent:"center",alignItems:"center",padding:20},modalContent:{backgroundColor:"white",padding:b.default.select({web:24,default:20}),borderRadius:8,width:b.default.select({web:"80%",default:"90%"}),maxWidth:500,maxHeight:"80%"},modalContentMobile:{padding:16,width:"95%",margin:10},modalTitle:{fontSize:18,fontWeight:"bold",marginBottom:10,textAlign:"center"},modalTitleMobile:{fontSize:16},modalSubtitle:{marginBottom:15,color:"#666",textAlign:"center"},modalSubtitleMobile:{fontSize:14,marginBottom:12},amountInput:{borderWidth:1,borderColor:"#ddd",borderRadius:6,padding:12,marginBottom:15,fontSize:16},amountInputMobile:{padding:15,fontSize:16,minHeight:48},modalButtons:{flexDirection:"row",justifyContent:"space-between",gap:12},modalButtonsMobile:{flexDirection:"column",gap:10},cancelBtn:{backgroundColor:"#ddd",padding:12,borderRadius:6,flex:1,alignItems:"center",minHeight:44,justifyContent:"center"},cancelBtnMobile:{width:"100%",detailRow:{marginBottom:8},detailLabel:{fontWeight:"bold",fontSize:14,color:"#333",marginBottom:2},detailLabelMobile:{fontSize:13},detailValue:{fontSize:14,color:"#555",flexWrap:"wrap"},detailValueMobile:{fontSize:14,lineHeight:20},personalDetailsGrid:{gap:8},personalDetailsGridMobile:{gap:6},financialGrid:{gap:8},employmentGrid:{gap:8},loanDetails:{backgroundColor:"#f8f9fa",padding:16,borderRadius:8,marginTop:16,borderWidth:1,borderColor:"#e0e0e0"},loanDetailsMobile:{padding:12,marginTop:12},loanDetailRow:{marginBottom:12},loanDetailValue:{fontSize:14,color:"#555",marginTop:4,fontWeight:"500"},loanDetailValueMobile:{fontSize:14,lineHeight:20},loanHistorySection:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:16,marginBottom:8},loanHistorySectionMobile:{flexDirection:"column",alignItems:"flex-start",gap:8},viewBtn:{backgroundColor:"#e9ecef",paddingHorizontal:16,paddingVertical:8,borderRadius:6,alignSelf:"flex-start",minHeight:36,justifyContent:"center"},viewBtnMobile:{paddingHorizontal:24,paddingVertical:14,minHeight:48,alignSelf:"stretch",backgroundColor:"#0066ff",flexDirection:"row",alignItems:"center",justifyContent:"center",gap:8},viewBtnText:{fontSize:14,color:"#333",fontWeight:"500"},viewBtnTextMobile:{fontSize:14,textAlign:"center"},sectionTitleMobile:{fontSize:16},subTitleMobile:{fontSize:14},detailsContainerMobile:{padding:12,marginBottom:12},creditBoxMobile:{padding:12,marginTop:12},creditScoreMobile:{fontSize:28,marginBottom:6},riskCategoryMobile:{fontSize:14,fontWeight:"600"},recommendationMobile:{fontSize:14,fontWeight:"600"},actionRowMobile:{flexDirection:"column",gap:10,marginTop:16},backBtnMobile:{width:"100%",paddingVertical:12,minHeight:48,justifyContent:"center"},editBtnMobile:{width:"100%",paddingVertical:12,minHeight:48,justifyContent:"center",backgroundColor:"#6c757d"},declineBtnMobile:{width:"100%",paddingVertical:12,minHeight:48,justifyContent:"center"},approveBtnMobile:{width:"100%",paddingVertical:12,minHeight:48,justifyContent:"center"},buttonText:{fontSize:14,fontWeight:"500",textAlign:"center"},buttonTextMobile:{fontSize:16},buttonTextWhite:{color:"#fff",fontSize:14,fontWeight:"500",textAlign:"center"},buttonTextWhiteMobile:{fontSize:16},errorTextMobile:{fontSize:14,textAlign:"center"},minHeight:48},saveBtn:{backgroundColor:"#007bff",padding:12,borderRadius:6,flex:1,alignItems:"center",minHeight:44,justifyContent:"center"},saveBtnMobile:{width:"100%",minHeight:48},modalButtonText:{fontSize:14,fontWeight:"500"},modalButtonTextMobile:{fontSize:16},modalButtonTextWhite:{color:"#fff",fontSize:14,fontWeight:"500"},modalButtonTextWhiteMobile:{fontSize:16},documentButton:{backgroundColor:"#ffffff",padding:b.default.select({web:16,default:14}),borderRadius:8,marginBottom:12,borderWidth:1,borderColor:"#e0e0e0",elevation:1,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2},documentButtonText:{fontSize:b.default.select({web:16,default:15}),color:"#333",fontWeight:"500",textAlign:"center"},closeButton:{backgroundColor:"#f8f9fa",padding:b.default.select({web:16,default:14}),borderRadius:8,marginTop:16,borderWidth:1,borderColor:"#dee2e6"},closeButtonText:{color:"#333",fontSize:b.default.select({web:16,default:15}),fontWeight:"500",textAlign:"center"},errorText:{color:"#e74c3c",marginBottom:10},successMessage:{position:"absolute",top:20,right:20,backgroundColor:"#2ecc71",padding:10,borderRadius:6},successText:{color:"white",fontWeight:"bold"},errorMessage:{position:"absolute",top:20,right:20,backgroundColor:"#e74c3c",padding:10,borderRadius:6},container:{backgroundColor:"#f6f6f6",flex:1},topbar:{flexDirection:"row",justifyContent:"space-between",backgroundColor:"#ddd",padding:b.default.select({web:20,default:16}),alignItems:"center"},topbarMobile:{padding:12},logo:{fontSize:b.default.select({web:22,default:20}),fontWeight:"bold"},logoMobile:{fontSize:18},role:{fontSize:b.default.select({web:14,default:12})},roleMobile:{fontSize:12},content:{flexDirection:"row",padding:b.default.select({web:20,default:16}),flexWrap:b.default.select({web:"nowrap",default:"wrap"})},contentMobile:{flexDirection:"column",padding:12,gap:0},left:{flex:b.default.select({web:1.1,default:1}),paddingRight:b.default.select({web:20,default:0}),borderRightWidth:b.default.select({web:1,default:0}),borderColor:"#ccc",minWidth:b.default.select({web:300,default:"100%"}),marginBottom:b.default.select({web:0,default:0})},leftMobile:{width:"100%",paddingRight:0,borderRightWidth:0,marginBottom:0},right:{flex:b.default.select({web:1.3,default:1}),paddingLeft:b.default.select({web:20,default:0}),minWidth:b.default.select({web:300,default:"100%"})},rightMobile:{width:"100%",paddingLeft:0,marginTop:0},detailsContainer:{backgroundColor:"#fff",padding:b.default.select({web:20,default:16}),borderRadius:8,borderWidth:1,borderColor:"#e0e0e0",marginBottom:16,width:"100%",alignSelf:"stretch"},sectionTitle:{fontWeight:"bold",fontSize:16,marginBottom:10},subTitle:{fontWeight:"bold",marginTop:10,marginBottom:6},bold:{fontWeight:"bold"},documentRow:{flexDirection:"row",justifyContent:"space-between",backgroundColor:"#eaeaea",paddingVertical:4,paddingHorizontal:8,marginBottom:4,borderRadius:4},docText:{fontSize:13,color:"#333"},viewBtn:{backgroundColor:"#0066ff",paddingHorizontal:32,paddingVertical:12,borderRadius:8,flexDirection:"row",alignItems:"center",gap:8,minWidth:120,justifyContent:"center"},creditBox:{backgroundColor:"#f8f9fa",padding:b.default.select({web:20,default:16}),borderRadius:8,marginTop:20,borderWidth:1,borderColor:"#e0e0e0"},creditScore:{fontSize:32,fontWeight:"bold",color:"#2ecc71",marginBottom:8},loanBox:{backgroundColor:"#f0f0f0",padding:12,marginTop:20,borderRadius:8},actionRow:{flexDirection:"row",gap:b.default.select({web:12,default:8}),marginTop:20,flexWrap:"wrap",alignItems:"center",width:"100%"},actionRowMobile:{justifyContent:"space-between",gap:8,flexDirection:b.default.select({web:"row",default:"column"})},btnMobile:{width:"100%",marginVertical:4,paddingVertical:12,alignItems:"center"},backBtn:{backgroundColor:"#ddd",paddingVertical:b.default.select({web:8,default:6}),paddingHorizontal:b.default.select({web:16,default:12}),borderRadius:6},editBtn:{backgroundColor:"#bbb",paddingVertical:b.default.select({web:8,default:6}),paddingHorizontal:b.default.select({web:16,default:12}),borderRadius:6},declineBtn:{backgroundColor:"#e74c3c",paddingVertical:b.default.select({web:8,default:6}),paddingHorizontal:b.default.select({web:16,default:12}),borderRadius:6},approveBtn:{backgroundColor:"#2ecc71",paddingVertical:b.default.select({web:8,default:6}),paddingHorizontal:b.default.select({web:16,default:12}),borderRadius:6}}),Ke=n(1690);function Xe(e){var t,n,o=e.navigation,r=e.route,a=(0,h.default)().width<768,i=(0,l.useRef)(),u=(0,l.useState)(""),g=(0,d.default)(u,2),y=g[0],x=g[1],w=(0,l.useState)(!1),j=(0,d.default)(w,2),v=j[0],C=j[1],S=(0,l.useContext)(m).currentUser,T=r.params,P=T.client,B=T.loanData,D=function(e){console.log("Signature captured"),x(e),C(!0)},A={style:{border:"none",borderRadius:"6px",backgroundColor:"#fff",width:"100%",height:"100%",display:"block"},className:"signature-canvas"};return(0,p.jsxs)(s.default,{style:Ye.container,children:[(0,p.jsxs)(s.default,{style:[Ye.header,a&&Ye.headerMobile],children:[(0,p.jsx)(f.default,{style:Ye.backBtn,onPress:function(){return o.goBack()},children:(0,p.jsx)(c.default,{style:Ye.backText,children:"\u2190 Back"})}),(0,p.jsxs)(s.default,{style:Ye.headerContent,children:[(0,p.jsxs)(c.default,{style:[Ye.title,a&&Ye.titleMobile],children:[(0,p.jsx)(c.default,{style:{color:"#0066ff"},children:"Loan"}),"Siya - Agreement Signature"]}),(0,p.jsxs)(c.default,{style:[Ye.subtitle,a&&Ye.subtitleMobile],children:["Client: ",P.name," | Amount: \u20b1",(null==B||null==(t=B.approvedAmount)?void 0:t.toLocaleString())||"0"]})]})]}),(0,p.jsxs)(s.default,{style:[Ye.agreementSummary,a&&Ye.agreementSummaryMobile],children:[(0,p.jsx)(c.default,{style:[Ye.summaryTitle,a&&Ye.summaryTitleMobile],children:"Loan Agreement Summary"}),(0,p.jsxs)(s.default,{style:Ye.summaryRow,children:[(0,p.jsx)(c.default,{style:Ye.summaryLabel,children:"Client Name:"}),(0,p.jsx)(c.default,{style:Ye.summaryValue,children:P.name})]}),(0,p.jsxs)(s.default,{style:Ye.summaryRow,children:[(0,p.jsx)(c.default,{style:Ye.summaryLabel,children:"Loan Amount:"}),(0,p.jsxs)(c.default,{style:Ye.summaryValue,children:["\u20b1",(null==B||null==(n=B.approvedAmount)?void 0:n.toLocaleString())||"0"]})]}),(0,p.jsxs)(s.default,{style:Ye.summaryRow,children:[(0,p.jsx)(c.default,{style:Ye.summaryLabel,children:"Interest Rate:"}),(0,p.jsxs)(c.default,{style:Ye.summaryValue,children:[(null==B?void 0:B.interestRate)||"5.0","%"]})]}),(0,p.jsxs)(s.default,{style:Ye.summaryRow,children:[(0,p.jsx)(c.default,{style:Ye.summaryLabel,children:"Term:"}),(0,p.jsxs)(c.default,{style:Ye.summaryValue,children:[(null==B?void 0:B.term)||"N/A"," months"]})]}),(0,p.jsxs)(s.default,{style:Ye.summaryRow,children:[(0,p.jsx)(c.default,{style:Ye.summaryLabel,children:"Repayment Method:"}),(0,p.jsx)(c.default,{style:Ye.summaryValue,children:(null==B?void 0:B.repaymentMethod)||"Monthly"})]})]}),(0,p.jsxs)(s.default,{style:[Ye.instructionsContainer,a&&Ye.instructionsContainerMobile],children:[(0,p.jsx)(c.default,{style:[Ye.instructionsTitle,a&&Ye.instructionsTitleMobile],children:"Digital Signature Required"}),(0,p.jsx)(c.default,{style:[Ye.instructionsText,a&&Ye.instructionsTextMobile],children:"As the Operations Manager, please sign below to approve this loan agreement. Your signature will be embedded in the promissory note document."})]}),(0,p.jsxs)(s.default,{style:[Ye.signatureContainer,a&&Ye.signatureContainerMobile],children:[(0,p.jsx)(c.default,{style:[Ye.signatureLabel,a&&Ye.signatureLabelMobile],children:"Operations Manager Signature:"}),(0,p.jsx)(s.default,{style:[Ye.signatureCanvas,a&&Ye.signatureCanvasMobile],children:"web"===b.default.OS?(0,p.jsxs)("div",{style:{width:"100%",height:"100%",position:"relative"},children:[(0,p.jsx)(Je,{ref:i,canvasProps:A,penColor:"#000000",backgroundColor:"#ffffff",dotSize:1.5,minWidth:.8,maxWidth:2.5,throttle:12,velocityFilterWeight:.8,onEnd:function(){}}),(0,p.jsx)("div",{style:{position:"absolute",bottom:"10px",right:"10px"},children:(0,p.jsx)("button",{onClick:function(){if(i.current&&!i.current.isEmpty()){var e=i.current.toDataURL("image/png");D(e)}},style:{backgroundColor:"#2ecc71",color:"white",border:"none",borderRadius:"4px",padding:"6px 12px",fontSize:"12px",cursor:"pointer"},children:"Save"})})]}):(0,p.jsx)(Je,{ref:i,onOK:D,onEmpty:function(){console.log("Signature is empty"),Ke.default.alert("Empty Signature","Please provide a signature before proceeding.")},descriptionText:"",clearText:"Clear",confirmText:"Save",autoClear:!1,imageType:"image/png",penColor:"#000000",backgroundColor:"#ffffff",minWidth:1,maxWidth:3,webStyle:"\n                .m-signature-pad {\n                  position: relative;\n                  font-size: 10px;\n                  width: 100%;\n                  height: 100%;\n                  border: 2px solid #ddd;\n                  border-radius: 8px;\n                  background-color: #fff;\n                }\n                .m-signature-pad--body {\n                  position: relative;\n                  overflow: hidden;\n                  width: 100%;\n                  height: 100%;\n                }\n                .m-signature-pad--body canvas {\n                  position: relative;\n                  left: 0;\n                  top: 0;\n                  width: 100%;\n                  height: 100%;\n                  touch-action: none;\n                  background-color: #fff;\n                }\n                .m-signature-pad--footer {\n                  position: absolute;\n                  left: 20px;\n                  right: 20px;\n                  bottom: 20px;\n                  height: 40px;\n                }\n                .m-signature-pad--footer .clear,\n                .m-signature-pad--footer .save {\n                  float: left;\n                  margin: 0 5px 5px 0;\n                  background: #0066ff;\n                  color: #fff;\n                  border: none;\n                  border-radius: 4px;\n                  padding: 8px 12px;\n                  cursor: pointer;\n                  font-size: 12px;\n                }\n                .m-signature-pad--footer .clear {\n                  background: #e74c3c;\n                }\n              "})}),v&&(0,p.jsx)(c.default,{style:[Ye.signatureStatus,a&&Ye.signatureStatusMobile],children:"\u2713 Signature captured successfully"})]}),(0,p.jsxs)(s.default,{style:[Ye.actionButtons,a&&Ye.actionButtonsMobile],children:[(0,p.jsx)(f.default,{style:[Ye.clearButton,a&&Ye.buttonMobile],onPress:function(){console.log("Clearing signature"),"web"===b.default.OS?i.current.clear():i.current.clearSignature(),x(""),C(!1)},children:(0,p.jsx)(c.default,{style:[Ye.clearButtonText,a&&Ye.buttonTextMobile],children:"Clear Signature"})}),(0,p.jsx)(f.default,{style:[Ye.confirmButton,a&&Ye.buttonMobile,!v&&Ye.disabledButton],onPress:function(){v?o.navigate("SignedAgreementPreview",{client:P,loanData:B,signature:y,signerName:(null==S?void 0:S.username)||"Operations Manager"}):Ke.default.alert("No Signature","Please provide a signature before proceeding.")},disabled:!v,children:(0,p.jsx)(c.default,{style:[Ye.confirmButtonText,a&&Ye.buttonTextMobile,!v&&Ye.disabledButtonText],children:"Preview Agreement"})})]})]})}"web"===b.default.OS&&n(2607),Je="web"===b.default.OS?n(96).default:n(5138).default;var Ye=g.default.create({container:{flex:1,backgroundColor:"#f6f6f6"},header:{flexDirection:"row",alignItems:"center",backgroundColor:"#fff",padding:b.default.select({web:20,default:16}),borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},headerMobile:{padding:12,flexDirection:"column",alignItems:"flex-start"},backBtn:{marginRight:b.default.select({web:20,default:12}),padding:b.default.select({web:8,default:6})},backText:{fontSize:b.default.select({web:16,default:14}),color:"#0066ff",fontWeight:"500"},headerContent:{flex:1},title:{fontSize:b.default.select({web:22,default:18}),fontWeight:"bold",marginBottom:4},titleMobile:{fontSize:16,marginTop:8},subtitle:{fontSize:b.default.select({web:14,default:12}),color:"#666"},subtitleMobile:{fontSize:12},agreementSummary:{backgroundColor:"#fff",margin:b.default.select({web:20,default:16}),padding:b.default.select({web:20,default:16}),borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},agreementSummaryMobile:{margin:12,padding:12},summaryTitle:{fontSize:b.default.select({web:18,default:16}),fontWeight:"bold",marginBottom:b.default.select({web:16,default:12}),color:"#333"},summaryTitleMobile:{fontSize:14,marginBottom:10},summaryRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:b.default.select({web:8,default:6})},summaryLabel:{fontSize:b.default.select({web:14,default:13}),color:"#666",fontWeight:"500"},summaryValue:{fontSize:b.default.select({web:14,default:13}),color:"#333",fontWeight:"600"},instructionsContainer:{backgroundColor:"#fff",marginHorizontal:b.default.select({web:20,default:16}),marginBottom:b.default.select({web:20,default:16}),padding:b.default.select({web:20,default:16}),borderRadius:8,borderLeftWidth:4,borderLeftColor:"#0066ff"},instructionsContainerMobile:{marginHorizontal:12,marginBottom:12,padding:12},instructionsTitle:{fontSize:b.default.select({web:16,default:14}),fontWeight:"bold",color:"#0066ff",marginBottom:b.default.select({web:8,default:6})},instructionsTitleMobile:{fontSize:14},instructionsText:{fontSize:b.default.select({web:14,default:13}),color:"#555",lineHeight:b.default.select({web:20,default:18})},instructionsTextMobile:{fontSize:12,lineHeight:16},signatureContainer:{backgroundColor:"#fff",marginHorizontal:b.default.select({web:20,default:16}),marginBottom:b.default.select({web:20,default:16}),padding:b.default.select({web:20,default:16}),borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},signatureContainerMobile:{marginHorizontal:12,marginBottom:12,padding:12},signatureLabel:{fontSize:b.default.select({web:16,default:14}),fontWeight:"bold",color:"#333",marginBottom:b.default.select({web:12,default:8})},signatureLabelMobile:{fontSize:14},signatureCanvas:{height:b.default.select({web:300,default:200}),borderWidth:2,borderColor:"#ddd",borderRadius:8,backgroundColor:"#fff",overflow:"hidden",position:"relative"},signatureCanvasMobile:{height:180},signatureStatus:{marginTop:b.default.select({web:12,default:8}),fontSize:b.default.select({web:14,default:12}),color:"#2ecc71",fontWeight:"600",textAlign:"center"},signatureStatusMobile:{fontSize:12},actionButtons:{flexDirection:"row",justifyContent:"space-between",paddingHorizontal:b.default.select({web:20,default:16}),paddingBottom:b.default.select({web:20,default:16}),gap:b.default.select({web:16,default:12})},actionButtonsMobile:{flexDirection:"column",paddingHorizontal:12,gap:10},clearButton:{backgroundColor:"#e74c3c",paddingVertical:b.default.select({web:12,default:10}),paddingHorizontal:b.default.select({web:24,default:20}),borderRadius:8,flex:b.default.select({web:1,default:0}),alignItems:"center",justifyContent:"center",minHeight:b.default.select({web:44,default:48})},saveButton:{backgroundColor:"#3498db",paddingVertical:b.default.select({web:12,default:10}),paddingHorizontal:b.default.select({web:24,default:20}),borderRadius:8,flex:b.default.select({web:1,default:0}),alignItems:"center",justifyContent:"center",minHeight:b.default.select({web:44,default:48})},confirmButton:{backgroundColor:"#2ecc71",paddingVertical:b.default.select({web:12,default:10}),paddingHorizontal:b.default.select({web:24,default:20}),borderRadius:8,flex:b.default.select({web:1,default:0}),alignItems:"center",justifyContent:"center",minHeight:b.default.select({web:44,default:48})},disabledButton:{backgroundColor:"#bdc3c7"},buttonMobile:{width:"100%",minHeight:48},clearButtonText:{color:"#fff",fontSize:b.default.select({web:16,default:14}),fontWeight:"600"},saveButtonText:{color:"#fff",fontSize:b.default.select({web:16,default:14}),fontWeight:"600"},confirmButtonText:{color:"#fff",fontSize:b.default.select({web:16,default:14}),fontWeight:"600"},disabledButtonText:{color:"#95a5a6"},buttonTextMobile:{fontSize:16}}),Qe=["documents"];function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function $e(e){var t,n=e.navigation,o=e.route,r=(0,h.default)().width<768,a=(0,l.useState)(!1),u=(0,d.default)(a,2),g=u[0],y=u[1],w=(0,l.useState)(null),j=(0,d.default)(w,2),v=j[0],S=j[1],T=(0,l.useState)(""),P=(0,d.default)(T,2),B=P[0],A=P[1],M=(0,l.useState)(!1),O=(0,d.default)(M,2),R=O[0],L=O[1],k=(0,l.useState)(!1),I=(0,d.default)(k,2),z=I[0],E=I[1],W=(0,l.useContext)(m).currentUser,N=J().updateLoan,H=o.params,V=H.client,_=H.loanData,U=H.signature,F=H.signerName;(0,l.useEffect)((function(){G()}),[]);var G=function(){var e=(0,i.default)((function*(){try{y(!0),A("");var e=yield fetch(C+"/generate-promissory-note",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({clientData:{name:V.name,address:V.address,cid:V.cid},loanData:{approvedAmount:(null==_?void 0:_.approvedAmount)||0,interestRate:(null==_?void 0:_.interestRate)||5,term:(null==_?void 0:_.term)||12,repaymentMethod:(null==_?void 0:_.repaymentMethod)||"Monthly"},signature:U,signerName:F||(null==W?void 0:W.username)||"Operations Manager"})});if(!e.ok)throw new Error("Failed to generate PDF");var t=yield e.blob(),n=URL.createObjectURL(t);S(n)}catch(o){console.error("Error generating PDF:",o),A("Failed to generate PDF preview. Please try again.")}finally{y(!1)}}));return function(){return e.apply(this,arguments)}}(),q=function(){var e=(0,i.default)((function*(){try{if(y(!0),A(""),console.log("Starting loan approval process..."),console.log("Client CID:",V.cid),console.log("Loan Data:",_),console.log("Signature present:",!!U),console.log("Signer name:",F),!(yield fetch(C+"/clients")).ok)throw new Error("API server is not responding properly");console.log("API health check passed");V.documents;var e=(0,He.default)(V,Qe),t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){(0,x.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({approvedAmount:null==_?void 0:_.approvedAmount,signature:U,signerName:F||(null==W?void 0:W.username)||"Operations Manager"},e);console.log("Sending approval data to API...");var n=yield D.processLoanDecision(V.cid,"approved",t);console.log("API Response:",n),console.log("Updating local state..."),yield N(V.cid,{status:"Approved",decidedAt:(new Date).toISOString(),approvedAmount:null==_?void 0:_.approvedAmount,signedBy:F||(null==W?void 0:W.username)||"Operations Manager",signedAt:(new Date).toISOString()}),console.log("Local state updated successfully"),y(!1),console.log("About to show success alert..."),setTimeout((function(){console.log("Showing success dialog now..."),E(!0)}),100)}catch(o){console.error("Error approving loan:",o),y(!1),A(o.message||"Failed to approve loan"),Ke.default.alert("Error",o.message||"Failed to approve loan. Please try again.",[{text:"OK"}])}}));return function(){return e.apply(this,arguments)}}(),K=function(){v&&URL.revokeObjectURL(v),n.goBack()};return g?(0,p.jsxs)(s.default,{style:[et.container,et.centerContent],children:[(0,p.jsx)(Z.default,{size:"large",color:"#0066ff"}),(0,p.jsx)(c.default,{style:[et.loadingText,r&&et.loadingTextMobile],children:v?"Processing loan approval...":"Generating PDF preview..."})]}):(0,p.jsxs)(s.default,{style:et.container,children:[(0,p.jsxs)(s.default,{style:[et.header,r&&et.headerMobile],children:[(0,p.jsx)(f.default,{style:et.backBtn,onPress:K,children:(0,p.jsx)(c.default,{style:et.backText,children:"\u2190 Back"})}),(0,p.jsxs)(s.default,{style:et.headerContent,children:[(0,p.jsxs)(c.default,{style:[et.title,r&&et.titleMobile],children:[(0,p.jsx)(c.default,{style:{color:"#0066ff"},children:"Loan"}),"Siya - Agreement Preview"]}),(0,p.jsx)(c.default,{style:[et.subtitle,r&&et.subtitleMobile],children:"Review and approve the signed loan agreement"})]})]}),(0,p.jsxs)(s.default,{style:[et.agreementDetails,r&&et.agreementDetailsMobile],children:[(0,p.jsx)(c.default,{style:[et.detailsTitle,r&&et.detailsTitleMobile],children:"Agreement Summary"}),(0,p.jsxs)(s.default,{style:et.detailRow,children:[(0,p.jsx)(c.default,{style:et.detailLabel,children:"Client:"}),(0,p.jsx)(c.default,{style:et.detailValue,children:V.name})]}),(0,p.jsxs)(s.default,{style:et.detailRow,children:[(0,p.jsx)(c.default,{style:et.detailLabel,children:"Amount:"}),(0,p.jsxs)(c.default,{style:et.detailValue,children:["\u20b1",(null==_||null==(t=_.approvedAmount)?void 0:t.toLocaleString())||"0"]})]}),(0,p.jsxs)(s.default,{style:et.detailRow,children:[(0,p.jsx)(c.default,{style:et.detailLabel,children:"Signed By:"}),(0,p.jsx)(c.default,{style:et.detailValue,children:F||(null==W?void 0:W.username)||"Operations Manager"})]}),(0,p.jsxs)(s.default,{style:et.detailRow,children:[(0,p.jsx)(c.default,{style:et.detailLabel,children:"Date:"}),(0,p.jsx)(c.default,{style:et.detailValue,children:(new Date).toLocaleDateString()})]})]}),(0,p.jsxs)(s.default,{style:[et.pdfContainer,r&&et.pdfContainerMobile],children:[(0,p.jsx)(c.default,{style:[et.pdfTitle,r&&et.pdfTitleMobile],children:"Signed Promissory Note Preview"}),B?(0,p.jsxs)(s.default,{style:et.errorContainer,children:[(0,p.jsx)(c.default,{style:[et.errorText,r&&et.errorTextMobile],children:B}),(0,p.jsx)(f.default,{style:et.retryBtn,onPress:G,children:(0,p.jsx)(c.default,{style:et.retryText,children:"Retry"})})]}):v?(0,p.jsx)(s.default,{style:[et.pdfPreview,r&&et.pdfPreviewMobile],children:"web"===b.default.OS?r?(0,p.jsxs)(s.default,{style:et.mobilePdfContainer,children:[(0,p.jsx)(c.default,{style:et.mobilePdfText,children:"\u2713 PDF Generated Successfully"}),(0,p.jsx)(c.default,{style:et.mobilePdfSubtext,children:"Due to mobile browser limitations, please click below to view the signed agreement in a new tab."}),(0,p.jsx)(f.default,{style:et.viewPdfBtn,onPress:function(){return window.open(v,"_blank")},children:(0,p.jsx)(c.default,{style:et.viewPdfText,children:"Open Signed Agreement"})})]}):(0,p.jsx)("iframe",{src:v,style:{width:"100%",height:"100%",border:"none",borderRadius:"8px"},title:"Signed Agreement Preview"}):(0,p.jsxs)(s.default,{style:et.pdfPlaceholder,children:[(0,p.jsx)(c.default,{style:et.pdfPlaceholderText,children:"PDF Preview Available"}),(0,p.jsx)(f.default,{style:et.viewPdfBtn,onPress:function(){"web"===b.default.OS&&window.open(v,"_blank")},children:(0,p.jsx)(c.default,{style:et.viewPdfText,children:"View PDF"})})]})}):(0,p.jsx)(s.default,{style:et.pdfPlaceholder,children:(0,p.jsx)(c.default,{style:et.pdfPlaceholderText,children:"Loading PDF preview..."})})]}),(0,p.jsxs)(s.default,{style:[et.actionButtons,r&&et.actionButtonsMobile],children:[(0,p.jsx)(f.default,{style:[et.backToSignBtn,r&&et.buttonMobile],onPress:K,children:(0,p.jsx)(c.default,{style:[et.backToSignText,r&&et.buttonTextMobile],children:"Back to Signature"})}),(0,p.jsx)(f.default,{style:[et.approveBtn,r&&et.buttonMobile],onPress:function(){console.log("handleApprove called"),L(!0)},disabled:g||!v,children:(0,p.jsx)(c.default,{style:[et.approveText,r&&et.buttonTextMobile],children:"Approve & Complete"})})]}),R&&(0,p.jsx)(s.default,{style:et.confirmOverlay,children:(0,p.jsxs)(s.default,{style:[et.confirmDialog,r&&et.confirmDialogMobile],children:[(0,p.jsx)(c.default,{style:[et.confirmTitle,r&&et.confirmTitleMobile],children:"Confirm Approval"}),(0,p.jsx)(c.default,{style:[et.confirmMessage,r&&et.confirmMessageMobile],children:"This will approve the loan and generate the signed agreement. This action cannot be undone."}),(0,p.jsxs)(s.default,{style:[et.confirmButtons,r&&et.confirmButtonsMobile],children:[(0,p.jsx)(f.default,{style:[et.confirmCancelBtn,r&&et.confirmButtonMobile],onPress:function(){console.log("User cancelled approval"),L(!1)},children:(0,p.jsx)(c.default,{style:et.confirmCancelText,children:"Cancel"})}),(0,p.jsx)(f.default,{style:[et.confirmApproveBtn,r&&et.confirmButtonMobile],onPress:function(){console.log("User confirmed approval"),L(!1),console.log("About to start processApproval..."),q()},children:(0,p.jsx)(c.default,{style:et.confirmApproveText,children:"Approve"})})]})]})}),z&&(0,p.jsx)(s.default,{style:et.confirmOverlay,children:(0,p.jsxs)(s.default,{style:[et.confirmDialog,r&&et.confirmDialogMobile],children:[(0,p.jsx)(c.default,{style:[et.successTitle,r&&et.confirmTitleMobile],children:"Success"}),(0,p.jsx)(c.default,{style:[et.confirmMessage,r&&et.confirmMessageMobile],children:"Loan has been approved and signed agreement has been generated."}),(0,p.jsx)(s.default,{style:[et.confirmButtons,r&&et.confirmButtonsMobile],children:(0,p.jsx)(f.default,{style:[et.successOkBtn,r&&et.confirmButtonMobile],onPress:function(){console.log("Success dialog OK button pressed"),console.log("Navigating back to OpsPendingList..."),E(!1);try{console.log("Attempting navigation reset..."),n.reset({index:0,routes:[{name:"OpsPendingList"}]}),console.log("Navigation reset successful")}catch(e){console.error("Reset navigation failed, trying replace:",e);try{n.replace("OpsPendingList"),console.log("Navigation replace successful")}catch(t){console.error("Replace navigation failed, trying navigate:",t),n.navigate("OpsPendingList"),console.log("Navigation navigate attempted")}}},children:(0,p.jsx)(c.default,{style:et.confirmApproveText,children:"OK"})})})]})})]})}var et=g.default.create({container:{flex:1,backgroundColor:"#f6f6f6"},centerContent:{justifyContent:"center",alignItems:"center"},header:{flexDirection:"row",alignItems:"center",backgroundColor:"#fff",padding:b.default.select({web:20,default:16}),borderBottomWidth:1,borderBottomColor:"#e0e0e0",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},headerMobile:{padding:12,flexDirection:"column",alignItems:"flex-start"},backBtn:{marginRight:b.default.select({web:20,default:12}),padding:b.default.select({web:8,default:6})},backText:{fontSize:b.default.select({web:16,default:14}),color:"#0066ff",fontWeight:"500"},headerContent:{flex:1},title:{fontSize:b.default.select({web:22,default:18}),fontWeight:"bold",marginBottom:4},titleMobile:{fontSize:16,marginTop:8},subtitle:{fontSize:b.default.select({web:14,default:12}),color:"#666"},subtitleMobile:{fontSize:12},agreementDetails:{backgroundColor:"#fff",margin:b.default.select({web:20,default:16}),padding:b.default.select({web:20,default:16}),borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2},agreementDetailsMobile:{margin:12,padding:12},detailsTitle:{fontSize:b.default.select({web:18,default:16}),fontWeight:"bold",marginBottom:b.default.select({web:16,default:12}),color:"#333"},detailsTitleMobile:{fontSize:14,marginBottom:10},detailRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:b.default.select({web:8,default:6})},detailLabel:{fontSize:b.default.select({web:14,default:13}),color:"#666",fontWeight:"500"},detailValue:{fontSize:b.default.select({web:14,default:13}),color:"#333",fontWeight:"600"},pdfContainer:{backgroundColor:"#fff",marginHorizontal:b.default.select({web:20,default:16}),marginBottom:b.default.select({web:20,default:16}),padding:b.default.select({web:20,default:16}),borderRadius:8,shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.1,shadowRadius:2,elevation:2,flex:1},pdfContainerMobile:{marginHorizontal:12,marginBottom:12,padding:12},pdfTitle:{fontSize:b.default.select({web:16,default:14}),fontWeight:"bold",color:"#333",marginBottom:b.default.select({web:12,default:8})},pdfTitleMobile:{fontSize:14},pdfPreview:{flex:1,backgroundColor:"#f9f9f9",borderRadius:8,borderWidth:1,borderColor:"#e0e0e0",overflow:"hidden"},pdfPreviewMobile:{minHeight:300},pdfPlaceholder:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f9f9f9",borderRadius:8,borderWidth:1,borderColor:"#e0e0e0",minHeight:b.default.select({web:400,default:200})},pdfPlaceholderText:{fontSize:b.default.select({web:16,default:14}),color:"#666",marginBottom:12},mobilePdfContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f9f9f9",borderRadius:8,borderWidth:1,borderColor:"#e0e0e0",padding:20,minHeight:300},mobilePdfText:{fontSize:18,fontWeight:"bold",color:"#2ecc71",marginBottom:12,textAlign:"center"},mobilePdfSubtext:{fontSize:14,color:"#666",marginBottom:20,textAlign:"center",lineHeight:20},viewPdfBtn:{backgroundColor:"#0066ff",paddingVertical:12,paddingHorizontal:20,borderRadius:8,minHeight:44,justifyContent:"center",alignItems:"center"},viewPdfText:{color:"#fff",fontSize:16,fontWeight:"600"},errorContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#f9f9f9",borderRadius:8,borderWidth:1,borderColor:"#e0e0e0",minHeight:b.default.select({web:400,default:200})},errorText:{color:"#e74c3c",fontSize:b.default.select({web:16,default:14}),marginBottom:12,textAlign:"center"},errorTextMobile:{fontSize:14},retryBtn:{backgroundColor:"#e74c3c",paddingVertical:8,paddingHorizontal:16,borderRadius:6},retryText:{color:"#fff",fontSize:14,fontWeight:"600"},loadingText:{marginTop:12,fontSize:b.default.select({web:16,default:14}),color:"#666",textAlign:"center"},loadingTextMobile:{fontSize:14},actionButtons:{flexDirection:"row",justifyContent:"space-between",paddingHorizontal:b.default.select({web:20,default:16}),paddingBottom:b.default.select({web:20,default:16}),gap:b.default.select({web:16,default:12})},actionButtonsMobile:{flexDirection:"column",paddingHorizontal:12,gap:10},backToSignBtn:{backgroundColor:"#6c757d",paddingVertical:b.default.select({web:12,default:10}),paddingHorizontal:b.default.select({web:24,default:20}),borderRadius:8,flex:b.default.select({web:1,default:0}),alignItems:"center",justifyContent:"center",minHeight:b.default.select({web:44,default:48})},approveBtn:{backgroundColor:"#2ecc71",paddingVertical:b.default.select({web:12,default:10}),paddingHorizontal:b.default.select({web:24,default:20}),borderRadius:8,flex:b.default.select({web:1,default:0}),alignItems:"center",justifyContent:"center",minHeight:b.default.select({web:44,default:48})},buttonMobile:{width:"100%",minHeight:48},backToSignText:{color:"#fff",fontSize:b.default.select({web:16,default:14}),fontWeight:"600"},approveText:{color:"#fff",fontSize:b.default.select({web:16,default:14}),fontWeight:"600"},buttonTextMobile:{fontSize:16},confirmOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",zIndex:1e3},confirmDialog:{backgroundColor:"#fff",padding:24,borderRadius:12,width:"80%",maxWidth:400,shadowColor:"#000",shadowOffset:{width:0,height:4},shadowOpacity:.25,shadowRadius:8,elevation:8},confirmDialogMobile:{width:"90%",padding:20},confirmTitle:{fontSize:18,fontWeight:"bold",color:"#333",marginBottom:12,textAlign:"center"},confirmTitleMobile:{fontSize:16},confirmMessage:{fontSize:14,color:"#666",lineHeight:20,textAlign:"center",marginBottom:20},confirmMessageMobile:{fontSize:14,marginBottom:16},confirmButtons:{flexDirection:"row",justifyContent:"space-between",gap:12},confirmButtonsMobile:{flexDirection:"column",gap:10},confirmCancelBtn:{backgroundColor:"#6c757d",paddingVertical:12,paddingHorizontal:24,borderRadius:8,flex:1,alignItems:"center",justifyContent:"center",minHeight:44},confirmApproveBtn:{backgroundColor:"#2ecc71",paddingVertical:12,paddingHorizontal:24,borderRadius:8,flex:1,alignItems:"center",justifyContent:"center",minHeight:44},confirmButtonMobile:{width:"100%",minHeight:48},confirmCancelText:{color:"#fff",fontSize:16,fontWeight:"600"},confirmApproveText:{color:"#fff",fontSize:16,fontWeight:"600"},successTitle:{fontSize:18,fontWeight:"bold",color:"#2ecc71",marginBottom:12,textAlign:"center"},successOkBtn:{backgroundColor:"#2ecc71",paddingVertical:12,paddingHorizontal:24,borderRadius:8,flex:1,alignItems:"center",justifyContent:"center",minHeight:44}});function tt(e){var t=e.navigation,n=J(),o=n.notifications,r=n.markNotificationsAsRead,a=n.loans,i=n.refreshClientData,u=(0,l.useState)(!1),g=(0,d.default)(u,2),h=g[0],b=g[1];(0,l.useEffect)((function(){r()}),[]),(0,l.useEffect)((function(){return t.addListener("focus",(function(){console.log("LoanOfficerNotifications focused - refreshing data"),b(!0),Promise.all(a.map((function(e){return i(e.cid)}))).catch((function(e){return console.error("Error refreshing client data:",e)})).finally((function(){return b(!1)}))}))}),[t,a]);return(0,p.jsxs)(s.default,{style:nt.container,children:[(0,p.jsxs)(s.default,{style:nt.headerRow,children:[(0,p.jsx)(c.default,{style:nt.header,children:"Hello Loan Officer!"}),(0,p.jsx)(f.default,{style:nt.dashboardBtn,onPress:function(){return t.navigate("LoanOfficerDashboard")},children:(0,p.jsx)(c.default,{style:nt.btnText,children:"Go to Dashboard"})})]}),(0,p.jsx)(c.default,{style:nt.subHeader,children:"Notifications"}),h&&(0,p.jsx)(s.default,{style:nt.refreshingContainer,children:(0,p.jsx)(c.default,{style:nt.refreshingText,children:"Refreshing..."})}),(0,p.jsx)(Q.default,{data:o,keyExtractor:function(e){return e.id.toString()},renderItem:function(e){var t=e.item,n="Approved"===t.status;return(0,p.jsxs)(s.default,{style:nt.item,children:["status_change"===t.type?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(c.default,{style:[nt.icon,{color:n?"green":"red"}],children:n?"\u2705":"\u274c"}),(0,p.jsxs)(c.default,{style:nt.message,children:["CID ",(0,p.jsx)(c.default,{style:nt.bold,children:t.cid})," LOAN REQUEST HAS BEEN"," ",(0,p.jsx)(c.default,{style:[nt.status,{color:n?"green":"red"}],children:t.status.toUpperCase()})," ","BY THE OPERATIONAL MANAGER"]})]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(c.default,{style:[nt.icon,{color:"#007bff"}],children:"\ud83d\udcb0"}),(0,p.jsxs)(c.default,{style:nt.message,children:["Loan amount for client"," ",(0,p.jsx)(c.default,{style:nt.bold,children:t.clientName})," (CID: ",t.cid,") has been updated to"," ",(0,p.jsxs)(c.default,{style:nt.bold,children:["\u20b1",t.amount.toLocaleString()]})]})]}),(0,p.jsx)(c.default,{style:nt.timestamp,children:new Date(t.timestamp).toLocaleString()})]})},ItemSeparatorComponent:function(){return(0,p.jsx)(s.default,{style:nt.separator})}})]})}var nt=g.default.create({container:{padding:24,backgroundColor:"#f6f6f6",flex:1},headerRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},header:{fontSize:24,fontWeight:"bold"},dashboardBtn:{backgroundColor:"#007bff",paddingVertical:8,paddingHorizontal:14,borderRadius:6},btnText:{color:"#fff",fontWeight:"600",fontSize:14},subHeader:{fontSize:18,fontWeight:"600",marginBottom:16},item:{flexDirection:"row",alignItems:"flex-start",paddingVertical:6},icon:{fontSize:18,marginRight:10,marginTop:2},message:{flex:1,fontSize:14,fontWeight:"500"},bold:{fontWeight:"bold"},status:{fontWeight:"bold",textTransform:"uppercase"},separator:{borderBottomWidth:1,borderColor:"#ccc",marginVertical:6},timestamp:{fontSize:12,color:"#666",marginTop:4,fontStyle:"italic"},refreshingContainer:{padding:10,backgroundColor:"#f0f0f0",alignItems:"center"},refreshingText:{color:"#666",fontSize:14}});function ot(e){var t,n,o,r,a=e.route,g=e.navigation,b=(0,l.useState)(""),m=(0,d.default)(b,2),y=m[0],x=m[1],w=(0,l.useState)(null),j=(0,d.default)(w,2),v=j[0],S=j[1],T=null==(t=a.params)?void 0:t.clientId,P=null==(n=a.params)?void 0:n.userRole,B=null==(o=a.params)?void 0:o.fromPendingDetail,D=J().loans.find((function(e){return e.cid===T})),A=(null==D||null==(r=D.loans)?void 0:r.loanHistory)||[];(0,l.useEffect)((function(){var e=function(){var e=(0,i.default)((function*(){if(T)try{var e=yield fetch(C+"/client-loan-data/"+T);if(e.ok){var t=yield e.json();S(t)}}catch(n){console.error("Error fetching loan terms:",n)}}));return function(){return e.apply(this,arguments)}}();e()}),[T]);var M=A.filter((function(e){return e.dateApplied.toLowerCase().includes(y.toLowerCase())||e.purpose.toLowerCase().includes(y.toLowerCase())||e.status.toLowerCase().includes(y.toLowerCase())})).sort((function(e,t){var n=new Date(e.dateApplied);return new Date(t.dateApplied)-n})),O=(0,h.default)().width<768;return(0,p.jsxs)(s.default,{style:[lt.container,O&&lt.containerMobile],children:[(0,p.jsxs)(s.default,{style:[lt.headerRow,O&&lt.headerRowMobile],children:[(0,p.jsxs)(c.default,{style:[lt.title,O&&lt.titleMobile],children:["Loan History of Client ",T]}),(0,p.jsxs)(s.default,{style:[lt.buttonContainer,O&&lt.buttonContainerMobile],children:[(0,p.jsx)(f.default,{style:[lt.btn,lt.backBtn,O&&lt.btnMobile],onPress:function(){if(B)g.goBack();else{var e="ops"===P?"OpsClientProfile":"ClientProfile";g.navigate(e,{client:{cid:T}})}},children:(0,p.jsx)(c.default,{style:lt.btnText,children:"Back to Profile"})}),(0,p.jsx)(f.default,{style:[lt.btn,lt.dashboardBtn,O&&lt.btnMobile],onPress:function(){var e="ops"===P?"OpsDashboard":"LoanOfficerDashboard";g.navigate(e)},children:(0,p.jsx)(c.default,{style:lt.btnText,children:"Go to Dashboard"})})]})]}),(0,p.jsx)(s.default,{style:[lt.searchBar,O&&lt.searchBarMobile],children:(0,p.jsx)(u.default,{style:[lt.searchInput,O&&lt.searchInputMobile],placeholder:"Search",value:y,onChangeText:x})}),!O&&(0,p.jsxs)(s.default,{style:lt.tableHeader,children:[(0,p.jsx)(c.default,{style:[lt.headerCell,{flex:2}],children:"Date Applied"}),(0,p.jsx)(c.default,{style:[lt.headerCell,{flex:2}],children:"Amount"}),(0,p.jsx)(c.default,{style:[lt.headerCell,{flex:3}],children:"Purpose"}),(0,p.jsx)(c.default,{style:[lt.headerCell,{flex:2}],children:"Status"}),(0,p.jsx)(c.default,{style:[lt.headerCell,{flex:2}],children:"Due Date"}),(0,p.jsx)(c.default,{style:[lt.headerCell,{flex:1}],children:"Paid?"})]}),(0,p.jsx)(Q.default,{data:M,keyExtractor:function(e,t){return t.toString()},renderItem:function(e){var t=e.item,n="Approved"===t.status,o="Declined"===t.status,l=t.dueDate||"N/A";return n&&v&&(l=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"monthly";if(!e||!t)return"N/A";var o=new Date(e);if("daily"===n.toLowerCase()){var l=30*t,r=new Date(o);return r.setDate(r.getDate()+l),r.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}if("weekly"===n.toLowerCase()){var a=Math.ceil(4.33*t),i=new Date(o);return i.setDate(i.getDate()+7*a),i.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}var d=new Date(o);return d.setMonth(d.getMonth()+parseInt(t)),d.toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}(t.dateApplied,v.term,v.repaymentMethod)),O?(0,p.jsxs)(s.default,{style:lt.cardContainer,children:[(0,p.jsxs)(s.default,{style:lt.cardRow,children:[(0,p.jsx)(c.default,{style:lt.cardLabel,children:"Date Applied:"}),(0,p.jsx)(c.default,{style:lt.cardValue,children:t.dateApplied})]}),(0,p.jsxs)(s.default,{style:lt.cardRow,children:[(0,p.jsx)(c.default,{style:lt.cardLabel,children:"Amount:"}),(0,p.jsxs)(c.default,{style:lt.cardValue,children:["\u20b1",t.amount.toLocaleString()]})]}),(0,p.jsxs)(s.default,{style:lt.cardRow,children:[(0,p.jsx)(c.default,{style:lt.cardLabel,children:"Purpose:"}),(0,p.jsx)(c.default,{style:lt.cardValue,children:t.purpose})]}),(0,p.jsxs)(s.default,{style:lt.cardRow,children:[(0,p.jsx)(c.default,{style:lt.cardLabel,children:"Status:"}),(0,p.jsx)(c.default,{style:[lt.cardValue,{color:n?"green":o?"red":"black"}],children:t.status})]}),(0,p.jsxs)(s.default,{style:lt.cardRow,children:[(0,p.jsx)(c.default,{style:lt.cardLabel,children:"Due Date:"}),(0,p.jsx)(c.default,{style:lt.cardValue,children:l})]}),(0,p.jsxs)(s.default,{style:lt.cardRow,children:[(0,p.jsx)(c.default,{style:lt.cardLabel,children:"Paid:"}),(0,p.jsx)(c.default,{style:lt.cardValue,children:t.paid?"Yes":"No"})]})]}):(0,p.jsxs)(s.default,{style:lt.row,children:[(0,p.jsx)(c.default,{style:[lt.cell,{flex:2}],children:t.dateApplied}),(0,p.jsxs)(c.default,{style:[lt.cell,{flex:2}],children:["\u20b1",t.amount.toLocaleString()]}),(0,p.jsx)(c.default,{style:[lt.cell,{flex:3}],children:t.purpose}),(0,p.jsx)(c.default,{style:[lt.cell,{flex:2,color:n?"green":o?"red":"black"}],children:t.status}),(0,p.jsx)(c.default,{style:[lt.cell,{flex:2}],children:l}),(0,p.jsx)(c.default,{style:[lt.cell,{flex:1}],children:t.paid?"Yes":"No"})]})},ItemSeparatorComponent:function(){return(0,p.jsx)(s.default,{style:lt.separator})}})]})}var lt=g.default.create({container:{padding:24,backgroundColor:"#f6f6f6",flex:1},containerMobile:{padding:16},headerRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},headerRowMobile:{flexDirection:"column",alignItems:"stretch",gap:16},title:{fontSize:20,fontWeight:"bold"},titleMobile:{fontSize:18,textAlign:"center"},buttonContainer:{flexDirection:"row",gap:8},buttonContainerMobile:{flexDirection:"column",gap:8},btn:{paddingVertical:8,paddingHorizontal:16,borderRadius:6},btnMobile:{paddingVertical:12,alignItems:"center"},backBtn:{backgroundColor:"#6c757d"},dashboardBtn:{backgroundColor:"#007bff"},btnText:{color:"#fff",fontWeight:"600",textAlign:"center"},searchBar:{marginBottom:12},searchBarMobile:{marginBottom:16},searchInput:{backgroundColor:"#ddd",borderRadius:6,padding:10},searchInputMobile:{padding:12},tableHeader:{flexDirection:"row",backgroundColor:"#dcdcdc",paddingVertical:10,paddingHorizontal:6,marginBottom:4},headerCell:{fontWeight:"bold",fontSize:14},row:{flexDirection:"row",alignItems:"center",paddingVertical:10},cell:{fontSize:13,paddingHorizontal:6},separator:{height:1,backgroundColor:"#ddd"},cardContainer:{backgroundColor:"white",borderRadius:8,padding:16,marginBottom:12,elevation:2,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4},cardRow:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:8},cardLabel:{fontSize:14,fontWeight:"600",color:"#666",flex:1},cardValue:{fontSize:14,flex:2,textAlign:"right"}}),rt=n(484);function at(e){var t=e.navigation,n=e.route,o=(0,l.useState)(!1),r=(0,d.default)(o,2),a=r[0],u=(r[1],(0,l.useState)(null)),g=(0,d.default)(u,2),h=g[0],b=(g[1],n.params),m=b.cid,y=b.title,x=b.documents,w=b.latestDate;return a?(0,p.jsxs)(s.default,{style:[it.container,it.centerContent],children:[(0,p.jsx)(Z.default,{size:"large",color:"#0066ff"}),(0,p.jsx)(c.default,{style:it.loadingText,children:"Loading documents..."})]}):h?(0,p.jsxs)(s.default,{style:[it.container,it.centerContent],children:[(0,p.jsx)(c.default,{style:it.errorText,children:h}),(0,p.jsx)(f.default,{style:it.retryBtn,onPress:function(){return t.goBack()},children:(0,p.jsx)(c.default,{style:it.retryText,children:"Retry"})})]}):(0,p.jsxs)(s.default,{style:it.container,children:[(0,p.jsxs)(s.default,{style:it.header,children:[(0,p.jsx)(f.default,{style:it.backBtn,onPress:function(){return t.goBack()},children:(0,p.jsx)(c.default,{children:"\u2190 Back"})}),(0,p.jsxs)(s.default,{style:it.headerContent,children:[(0,p.jsx)(c.default,{style:it.title,children:y}),(0,p.jsx)(c.default,{style:it.subtitle,children:w})]})]}),(0,p.jsx)(re.default,{style:it.content,children:(0,p.jsx)(s.default,{style:it.grid,children:x.map((function(e){return function(e){var t=e.name.toLowerCase().endsWith(".pdf");return(0,p.jsxs)(f.default,{style:it.documentCard,onPress:(0,i.default)((function*(){try{var t=yield D.viewDocumentByFilename(m,e.name,w),n=t.url;t.type,window.open(n,"_blank"),setTimeout((function(){return URL.revokeObjectURL(n)}),1e3)}catch(h){console.error("Error viewing document:",h),alert("Error viewing document. Please try again.")}})),children:[(0,p.jsx)(s.default,{style:it.previewContainer,children:t?(0,p.jsx)(s.default,{style:it.pdfPreview,children:(0,p.jsx)(c.default,{style:it.pdfIcon,children:"PDF"})}):(0,p.jsx)(rt.default,{source:{uri:C+"/documents/"+m+"/thumbnail/"+e.name+"?date="+encodeURIComponent(w)},style:it.imagePreview,resizeMode:"contain"})}),(0,p.jsx)(c.default,{style:it.documentName,children:e.displayName})]},e.name)}(e)}))})})]})}var it=g.default.create({container:{flex:1,backgroundColor:"#f6f6f6"},header:{flexDirection:"row",alignItems:"center",padding:16,backgroundColor:"#fff",borderBottomWidth:1,borderBottomColor:"#eee"},backBtn:{marginRight:16},title:{fontSize:18,fontWeight:"bold"},content:{flex:1,padding:16},grid:{flexDirection:"row",flexWrap:"wrap",gap:16,justifyContent:"space-between",paddingBottom:20},headerContent:{flex:1,marginLeft:16},subtitle:{fontSize:12,color:"#666",marginTop:4},documentCard:{width:"48%",backgroundColor:"#fff",borderRadius:8,overflow:"hidden",shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.1,shadowRadius:4,elevation:3},previewContainer:{width:"100%",height:150,backgroundColor:"#f5f5f5",justifyContent:"center",alignItems:"center"},imagePreview:{width:"100%",height:"100%"},pdfPreview:{width:"100%",height:"100%",justifyContent:"center",alignItems:"center",backgroundColor:"#e0e0e0"},pdfIcon:{fontSize:24,fontWeight:"bold",color:"#666"},documentName:{padding:12,fontSize:14,textAlign:"center"},centerContent:{justifyContent:"center",alignItems:"center"},loadingText:{marginTop:10,fontSize:16,color:"#666"},errorText:{color:"#dc3545",fontSize:16,marginBottom:15},retryBtn:{backgroundColor:"#0066ff",paddingVertical:8,paddingHorizontal:20,borderRadius:6},retryText:{color:"#fff",fontWeight:"bold"}}),dt=(0,a.default)();(0,o.default)((function(){return(0,p.jsx)(y,{children:(0,p.jsx)(k,{children:(0,p.jsx)(G,{children:(0,p.jsx)(r.default,{children:(0,p.jsxs)(dt.Navigator,{initialRouteName:"Login",screenOptions:{headerShown:!1},children:[(0,p.jsx)(dt.Screen,{name:"Login",component:A}),(0,p.jsx)(dt.Screen,{name:"ForgotPassword",component:O}),(0,p.jsx)(dt.Screen,{name:"Dashboard",component:N}),(0,p.jsx)(dt.Screen,{name:"OpsDashboard",component:q}),(0,p.jsx)(dt.Screen,{name:"UserManagement",component:Ae}),(0,p.jsx)(dt.Screen,{name:"AddEditUser",component:ke}),(0,p.jsx)(dt.Screen,{name:"LoanOfficerDashboard",component:X}),(0,p.jsx)(dt.Screen,{name:"ClientList",component:le}),(0,p.jsx)(dt.Screen,{name:"ClientProfile",component:xe}),(0,p.jsx)(dt.Screen,{name:"TotalLoanList",component:ve}),(0,p.jsx)(dt.Screen,{name:"PendingLoanDetail",component:Be}),(0,p.jsx)(dt.Screen,{name:"OpsClientList",component:ze}),(0,p.jsx)(dt.Screen,{name:"OpsClientProfile",component:Ee}),(0,p.jsx)(dt.Screen,{name:"OpsPendingList",component:We}),(0,p.jsx)(dt.Screen,{name:"OpsPendingLoanDetail",component:Ge}),(0,p.jsx)(dt.Screen,{name:"SignatureAgreement",component:Xe}),(0,p.jsx)(dt.Screen,{name:"SignedAgreementPreview",component:$e}),(0,p.jsx)(dt.Screen,{name:"LoanOfficerNotifications",component:tt}),(0,p.jsx)(dt.Screen,{name:"LoanHistory",component:ot}),(0,p.jsx)(dt.Screen,{name:"DocumentPreview",component:at,options:function(e){e.route;return{headerShown:!1}}})]})})})})})}))}},t={};function n(o){var l=t[o];if(void 0!==l)return l.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.m=e,(()=>{var e=[];n.O=(t,o,l,r)=>{if(!o){var a=1/0;for(c=0;c<e.length;c++){for(var[o,l,r]=e[c],i=!0,d=0;d<o.length;d++)(!1&r||a>=r)&&Object.keys(n.O).every((e=>n.O[e](o[d])))?o.splice(d--,1):(i=!1,r<a&&(a=r));if(i){e.splice(c--,1);var s=l();void 0!==s&&(t=s)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[o,l,r]}})(),n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(o,l){if(1&l&&(o=this(o)),8&l)return o;if("object"===typeof o&&o){if(4&l&&o.__esModule)return o;if(16&l&&"function"===typeof o.then)return o}var r=Object.create(null);n.r(r);var a={};e=e||[null,t({}),t([]),t(t)];for(var i=2&l&&o;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((e=>a[e]=()=>o[e]));return a.default=()=>o,n.d(r,a),r}})(),n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};n.O.j=t=>0===e[t];var t=(t,o)=>{var l,r,[a,i,d]=o,s=0;if(a.some((t=>0!==e[t]))){for(l in i)n.o(i,l)&&(n.m[l]=i[l]);if(d)var c=d(n)}for(t&&t(o);s<a.length;s++)r=a[s],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(c)},o=self.webpackChunkweb=self.webpackChunkweb||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var o=n.O(void 0,[940],(()=>n(4454)));o=n.O(o)})();
//# sourceMappingURL=main.f5eaf7bf.js.map